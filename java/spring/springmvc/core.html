<!doctype html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.8" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.31" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://x.app/notebook/java/spring/springmvc/core.html"><meta property="og:site_name" content="Notebook"><meta property="og:title" content="SpringMVCåº”ç”¨å®è·µ"><meta property="og:description" content="Controllerå’ŒHandler åœ¨Spring MVCæ¡†æ¶ä¸­ï¼ŒControlleræ˜¯MVCæ¶æ„ä¸­çš„â€œCâ€éƒ¨åˆ†ï¼Œå³æ§åˆ¶å™¨ã€‚å®ƒæ˜¯ä¸€ä¸ªç”¨æ¥æ¥æ”¶HTTPè¯·æ±‚çš„ç»„ä»¶ï¼Œå¤„ç†ç”¨æˆ·çš„è¾“å…¥ï¼Œä¸ºç”¨æˆ·è¯·æ±‚æ‰§è¡Œé€‚å½“çš„ä¸šåŠ¡é€»è¾‘ï¼Œå¹¶è¿”å›ç›¸åº”çš„è§†å›¾ç»™ç”¨æˆ·ã€‚ä»¥ä¸‹æ˜¯Controllerçš„ä¸€äº›å…³é”®ç‰¹ç‚¹ï¼š æ§åˆ¶å™¨çš„è§’è‰²å’ŒèŒè´£ï¼š è¯·æ±‚æ˜ å°„ï¼š åˆ©ç”¨@RequestMappingæˆ–è€…å…·ä½“çš„..."><meta property="og:type" content="article"><meta property="og:locale" content="en-US"><meta property="og:updated_time" content="2024-05-07T15:59:24.000Z"><meta property="article:author" content="Mr.Topple"><meta property="article:modified_time" content="2024-05-07T15:59:24.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"SpringMVCåº”ç”¨å®è·µ","image":[""],"dateModified":"2024-05-07T15:59:24.000Z","author":[{"@type":"Person","name":"Mr.Topple","url":"https://www.baidu.com"}]}</script><title>SpringMVCåº”ç”¨å®è·µ | Notebook</title><meta name="description" content="Controllerå’ŒHandler åœ¨Spring MVCæ¡†æ¶ä¸­ï¼ŒControlleræ˜¯MVCæ¶æ„ä¸­çš„â€œCâ€éƒ¨åˆ†ï¼Œå³æ§åˆ¶å™¨ã€‚å®ƒæ˜¯ä¸€ä¸ªç”¨æ¥æ¥æ”¶HTTPè¯·æ±‚çš„ç»„ä»¶ï¼Œå¤„ç†ç”¨æˆ·çš„è¾“å…¥ï¼Œä¸ºç”¨æˆ·è¯·æ±‚æ‰§è¡Œé€‚å½“çš„ä¸šåŠ¡é€»è¾‘ï¼Œå¹¶è¿”å›ç›¸åº”çš„è§†å›¾ç»™ç”¨æˆ·ã€‚ä»¥ä¸‹æ˜¯Controllerçš„ä¸€äº›å…³é”®ç‰¹ç‚¹ï¼š æ§åˆ¶å™¨çš„è§’è‰²å’ŒèŒè´£ï¼š è¯·æ±‚æ˜ å°„ï¼š åˆ©ç”¨@RequestMappingæˆ–è€…å…·ä½“çš„...">
    <link rel="preload" href="/notebook/assets/style-CtQ2YzZh.css" as="style"><link rel="stylesheet" href="/notebook/assets/style-CtQ2YzZh.css">
    <link rel="modulepreload" href="/notebook/assets/app-CxJd8nF7.js"><link rel="modulepreload" href="/notebook/assets/core.html-DTcq3ly_.js"><link rel="modulepreload" href="/notebook/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/notebook/assets/index.html-9nN9_6bx.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-CKbceyMm.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-iHZfZxpT.js" as="script"><link rel="prefetch" href="/notebook/assets/Gradle.html-B6wsOksL.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-BUVTWAsG.js" as="script"><link rel="prefetch" href="/notebook/assets/maven.html-D5-hHZrZ.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-DD1Lld8N.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-_BbriX_g.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-DAccSJhC.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-Bf9X9jvT.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-B19-EfSe.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-DRmxtPSC.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-CjVSaMdH.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-B0fC1_-T.js" as="script"><link rel="prefetch" href="/notebook/assets/pywin32.html-px0vUcIi.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-CdO4VgNB.js" as="script"><link rel="prefetch" href="/notebook/assets/damb.html-dTXiqZmc.js" as="script"><link rel="prefetch" href="/notebook/assets/sd.html-By377HXE.js" as="script"><link rel="prefetch" href="/notebook/assets/yolo.html-DzpXVhLv.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-DA91jZpm.js" as="script"><link rel="prefetch" href="/notebook/assets/env.html-CbhhYrs-.js" as="script"><link rel="prefetch" href="/notebook/assets/Docker.html-CQEh5g7w.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-AsPVvth3.js" as="script"><link rel="prefetch" href="/notebook/assets/Linux-install.html-D5iotnE7.js" as="script"><link rel="prefetch" href="/notebook/assets/Linux.html-VSsL9USo.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-C9kJN2st.js" as="script"><link rel="prefetch" href="/notebook/assets/shell.html-BHLK3-GW.js" as="script"><link rel="prefetch" href="/notebook/assets/vim.html-CJwcD3hp.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-CRZoL2hn.js" as="script"><link rel="prefetch" href="/notebook/assets/mysql-1.html-DfUpWsym.js" as="script"><link rel="prefetch" href="/notebook/assets/mysql-2.html-Ddiwndc3.js" as="script"><link rel="prefetch" href="/notebook/assets/redis.html-CBZOxkAg.js" as="script"><link rel="prefetch" href="/notebook/assets/sql.html-ByKTMTIO.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-DJJ5ZMps.js" as="script"><link rel="prefetch" href="/notebook/assets/git.html-CexF2Y-t.js" as="script"><link rel="prefetch" href="/notebook/assets/github.html-3ZhEpskT.js" as="script"><link rel="prefetch" href="/notebook/assets/gitlab.html-iPhky3W2.js" as="script"><link rel="prefetch" href="/notebook/assets/jenkins.html-DfKaqplD.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-DvNaF49J.js" as="script"><link rel="prefetch" href="/notebook/assets/idea.html-BeROj0NW.js" as="script"><link rel="prefetch" href="/notebook/assets/mac.html-DuGUh1jL.js" as="script"><link rel="prefetch" href="/notebook/assets/windows.html-ma-DzIP4.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-DV1gpx8e.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-GiQwYQun.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-C-2sWnCs.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-Dl9-FfGm.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-i9LjgteB.js" as="script"><link rel="prefetch" href="/notebook/assets/Servlet.html-c_Zm64zl.js" as="script"><link rel="prefetch" href="/notebook/assets/http.html-D6WEy_Cb.js" as="script"><link rel="prefetch" href="/notebook/assets/jsp.html-4hVACIYL.js" as="script"><link rel="prefetch" href="/notebook/assets/mvc.html-CLPdTUg-.js" as="script"><link rel="prefetch" href="/notebook/assets/socket.html-DG-WgVeM.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-N7nh9O9J.js" as="script"><link rel="prefetch" href="/notebook/assets/nginx.html-Bjt8z31c.js" as="script"><link rel="prefetch" href="/notebook/assets/tomcat.html-BmgWvwKq.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-OvGHJxmF.js" as="script"><link rel="prefetch" href="/notebook/assets/mybatis-generator.html-C9UhUoIc.js" as="script"><link rel="prefetch" href="/notebook/assets/mybatis-plus.html-CLXgoJK-.js" as="script"><link rel="prefetch" href="/notebook/assets/mybatis-resource.html-Cc3ahKQb.js" as="script"><link rel="prefetch" href="/notebook/assets/mybatis.html-gj64ZSUp.js" as="script"><link rel="prefetch" href="/notebook/assets/tk-mybatis.html-BNxhrrlm.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-C8ja1GnO.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-7A9OBIs3.js" as="script"><link rel="prefetch" href="/notebook/assets/design.html-Cr3cjyoE.js" as="script"><link rel="prefetch" href="/notebook/assets/life.html-CejST_F2.js" as="script"><link rel="prefetch" href="/notebook/assets/spring.html-Co_n3yE1.js" as="script"><link rel="prefetch" href="/notebook/assets/transaction.html-NqY4foWR.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-CGoYyEeu.js" as="script"><link rel="prefetch" href="/notebook/assets/log.html-Dx6WOMK6.js" as="script"><link rel="prefetch" href="/notebook/assets/test.html-aarO1SzV.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-CYhktR5M.js" as="script"><link rel="prefetch" href="/notebook/assets/sec.html-CPFCI5fZ.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-eCsW9e9A.js" as="script"><link rel="prefetch" href="/notebook/assets/crossDomain.html-px_Yvs7T.js" as="script"><link rel="prefetch" href="/notebook/assets/springboot.html-B9rjzX0G.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-D3pJ-GGh.js" as="script"><link rel="prefetch" href="/notebook/assets/hello.html-B0ADBJxt.js" as="script"><link rel="prefetch" href="/notebook/assets/JavaåŸºç¡€.html-DT2LS_-r.js" as="script"><link rel="prefetch" href="/notebook/assets/Javaå¸¸ç”¨ç±»åº“.html-CzpXa90l.js" as="script"><link rel="prefetch" href="/notebook/assets/Javaé¢å‘å¯¹è±¡.html-BV_Zt2gg.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-BsQ2sMnI.js" as="script"><link rel="prefetch" href="/notebook/assets/æ•°ç»„å’Œå­—ç¬¦ä¸².html-BLk0SuGN.js" as="script"><link rel="prefetch" href="/notebook/assets/JaråŒ…çš„å¯¼å…¥.html-DGn4LyS_.js" as="script"><link rel="prefetch" href="/notebook/assets/Javaå†å²åŠç®€ä»‹.html-Br184MFn.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-DSS5-5ow.js" as="script"><link rel="prefetch" href="/notebook/assets/env.html-C7hcYWjF.js" as="script"><link rel="prefetch" href="/notebook/assets/åŸç åç å’Œè¡¥ç .html-CA2meEcj.js" as="script"><link rel="prefetch" href="/notebook/assets/HashMapæºç åˆ†æ.html-OGM3E29q.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-WV9Q3BjL.js" as="script"><link rel="prefetch" href="/notebook/assets/collection.html-C1z6tHGc.js" as="script"><link rel="prefetch" href="/notebook/assets/generics.html-DPZjGIJg.js" as="script"><link rel="prefetch" href="/notebook/assets/setå’Œmap.html-BNX9oanH.js" as="script"><link rel="prefetch" href="/notebook/assets/Jvmå†…å­˜ç®¡ç†.html-zkNCDuS4.js" as="script"><link rel="prefetch" href="/notebook/assets/Jvmç±»åŠ è½½.html--8sPMfjT.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-Bj1kw-lY.js" as="script"><link rel="prefetch" href="/notebook/assets/Specification.html-CcMe6n5T.js" as="script"><link rel="prefetch" href="/notebook/assets/gc.html-Bmum3g6L.js" as="script"><link rel="prefetch" href="/notebook/assets/Annotation.html-BUdFjlQg.js" as="script"><link rel="prefetch" href="/notebook/assets/Enum.html-BaQ59vyR.js" as="script"><link rel="prefetch" href="/notebook/assets/Lambda.html-BQ1Gqlm-.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-Cx3Q3OOi.js" as="script"><link rel="prefetch" href="/notebook/assets/Reflection.html-TEUvY7HE.js" as="script"><link rel="prefetch" href="/notebook/assets/Stream.html-_8TKeqYc.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-Cmexpdh0.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-XaidtzD7.js" as="script"><link rel="prefetch" href="/notebook/assets/base.html-CNtKqU7R.js" as="script"><link rel="prefetch" href="/notebook/assets/numpy.html-CxvBR0Wn.js" as="script"><link rel="prefetch" href="/notebook/assets/opencv.html-BhW7GaOh.js" as="script"><link rel="prefetch" href="/notebook/assets/pillow.html-Cn3Gmkdm.js" as="script"><link rel="prefetch" href="/notebook/assets/python.html-Do84x94I.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-B7mnj53j.js" as="script"><link rel="prefetch" href="/notebook/assets/base.html-Da9lUEAB.js" as="script"><link rel="prefetch" href="/notebook/assets/data.html-Z-JUC9Wt.js" as="script"><link rel="prefetch" href="/notebook/assets/file.html-BwNpND8l.js" as="script"><link rel="prefetch" href="/notebook/assets/function.html-BXYDiqkQ.js" as="script"><link rel="prefetch" href="/notebook/assets/oop.html-DpeDYk0l.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-CAzS8I83.js" as="script"><link rel="prefetch" href="/notebook/assets/numpy.html-Bc-a_AWX.js" as="script"><link rel="prefetch" href="/notebook/assets/pandas.html-B52zzDZn.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-BV6vNf03.js" as="script"><link rel="prefetch" href="/notebook/assets/css.html-BHWoXEzf.js" as="script"><link rel="prefetch" href="/notebook/assets/css2.html-_TLQsJ3o.js" as="script"><link rel="prefetch" href="/notebook/assets/css3.html-BzqIKppQ.js" as="script"><link rel="prefetch" href="/notebook/assets/css4.html-CRfca9dl.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-CaudFGJ4.js" as="script"><link rel="prefetch" href="/notebook/assets/html.html-BdfvV_7N.js" as="script"><link rel="prefetch" href="/notebook/assets/html5.html-BPzEOGgB.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-CPgwY9QD.js" as="script"><link rel="prefetch" href="/notebook/assets/dom.html-BE8pwfNU.js" as="script"><link rel="prefetch" href="/notebook/assets/es6.html-CsDcQS0L.js" as="script"><link rel="prefetch" href="/notebook/assets/js.html-izcmr2t9.js" as="script"><link rel="prefetch" href="/notebook/assets/js2.html-nsSd0mmD.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-B_OBNWil.js" as="script"><link rel="prefetch" href="/notebook/assets/ts.html-DTPZUtUz.js" as="script"><link rel="prefetch" href="/notebook/assets/ts2.html-SKOaTa0s.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-BVbxInDR.js" as="script"><link rel="prefetch" href="/notebook/assets/react.html-CkPU1p60.js" as="script"><link rel="prefetch" href="/notebook/assets/ui.html-Cs9Z6Ekk.js" as="script"><link rel="prefetch" href="/notebook/assets/vue.html-DChyFYoE.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-vXIXL2Bq.js" as="script"><link rel="prefetch" href="/notebook/assets/build.html-B8b4Bq4o.js" as="script"><link rel="prefetch" href="/notebook/assets/format.html-DVJeu2lg.js" as="script"><link rel="prefetch" href="/notebook/assets/node.html-CDNzW3Nx.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-D3REuNFc.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-BOtTNhr7.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-9nkYmsOz.js" as="script"><link rel="prefetch" href="/notebook/assets/baz.html-DLPpQJ-U.js" as="script"><link rel="prefetch" href="/notebook/assets/index.html-Ceid1slw.js" as="script"><link rel="prefetch" href="/notebook/assets/ray.html-DFkGEtzw.js" as="script"><link rel="prefetch" href="/notebook/assets/404.html-D77I26Lp.js" as="script"><link rel="prefetch" href="/notebook/assets/giscus--_FS5kYt.js" as="script"><link rel="prefetch" href="/notebook/assets/flowchart-966sEcGG.js" as="script"><link rel="prefetch" href="/notebook/assets/mermaid.core-D2993n9l.js" as="script"><link rel="prefetch" href="/notebook/assets/photoswipe.esm-GXRgw7eJ.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">Skip to main content</a><!--]--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="route-link vp-brand" href="/notebook/"><img class="vp-nav-logo" src="/notebook/note" alt><!----><span class="vp-site-name hide-in-pad">Notebook</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a class="route-link nav-link" href="/notebook/" aria-label="Home"><span class="font-icon icon iconfont icon-home" style=""></span>Home<!----></a></div><div class="nav-item hide-in-mobile"><a class="route-link nav-link active" href="/notebook/java/" aria-label="Java"><span class="font-icon icon iconfont icon-java" style=""></span>Java<!----></a></div><div class="nav-item hide-in-mobile"><a class="route-link nav-link" href="/notebook/web/" aria-label="Web"><span class="font-icon icon iconfont icon-web" style=""></span>Web<!----></a></div><div class="nav-item hide-in-mobile"><a class="route-link nav-link" href="/notebook/python/" aria-label="Python"><span class="font-icon icon iconfont icon-python" style=""></span>Python<!----></a></div><div class="nav-item hide-in-mobile"><a href="https://theme-hope.vuejs.press/" rel="noopener noreferrer" target="_blank" aria-label="Theme" class="nav-link"><span class="font-icon icon iconfont icon-book" style=""></span>Theme<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="nav-item vp-repo"><a class="vp-repo-link" href="https://github.com/vuepress-theme-hope/vuepress-theme-hope" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><p class="vp-sidebar-header clickable active"><span class="font-icon icon iconfont icon-code" style=""></span><a class="route-link nav-link vp-sidebar-title" href="/notebook/java/syntax/" aria-label="Java Programming"><!---->Java Programming<!----></a><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-syntax" style=""></span><span class="vp-sidebar-title">JavaåŸºç¡€è¯­æ³•</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-javaEE" style=""></span><span class="vp-sidebar-title">JavaWebå¼€å‘</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><span class="font-icon icon iconfont icon-spring" style=""></span><span class="vp-sidebar-title">Springæ¡†æ¶</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Spring</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">SpringMVC</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/notebook/java/spring/springmvc/hello.html" aria-label="SpringMVCå¿«é€Ÿä¸Šæ‰‹"><!---->SpringMVCå¿«é€Ÿä¸Šæ‰‹<!----></a></li><li><a class="route-link nav-link active vp-sidebar-link vp-sidebar-page active" href="/notebook/java/spring/springmvc/core.html" aria-label="SpringMVCåº”ç”¨å®è·µ"><!---->SpringMVCåº”ç”¨å®è·µ<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">SpringBoot</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Spring Security</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">å•å…ƒæµ‹è¯•ä¸æ—¥å¿—ç®¡ç†</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-db" style=""></span><span class="vp-sidebar-title">æ•°æ®åº“ä¸ORMæ¡†æ¶</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!--[--><!----><!--]--><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->SpringMVCåº”ç”¨å®è·µ</h1><div class="page-info"><span class="page-author-info" aria-label="AuthorğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://www.baidu.com" target="_blank" rel="noopener noreferrer">Mr.Topple</a></span><span property="author" content="Mr.Topple"></span></span><!----><span class="page-date-info" aria-label="Writing DateğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-05-07T15:59:24.000Z"></span><!----><span class="page-reading-time-info" aria-label="Reading TimeâŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 40 min</span><meta property="timeRequired" content="PT40M"></span><!----><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!--[--><!----><!--]--><div class="vp-toc-header">On This Page<button type="button" class="print-button" title="Print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="/notebook/#controllerå’Œhandler">Controllerå’ŒHandler</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="/notebook/#ä¼ ç»Ÿservletå¼€å‘æ¨¡å¼">ä¼ ç»ŸServletå¼€å‘æ¨¡å¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="/notebook/#è¯·æ±‚å¤„ç†æ–¹æ³•ç›¸å…³æ³¨è§£">è¯·æ±‚å¤„ç†æ–¹æ³•ç›¸å…³æ³¨è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="/notebook/#è¯·æ±‚å‚æ•°ç›¸å…³æ³¨è§£">è¯·æ±‚å‚æ•°ç›¸å…³æ³¨è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="/notebook/#uriè·¯å¾„æ˜ å°„è§„åˆ™">URIè·¯å¾„æ˜ å°„è§„åˆ™</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="/notebook/#å“åº”è§†å›¾æˆ–jsonæ•°æ®">å“åº”è§†å›¾æˆ–Jsonæ•°æ®</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="/notebook/#restful-webæœåŠ¡">RESTful WebæœåŠ¡</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="/notebook/#è¯·æ±‚å‚æ•°ç±»å‹è½¬æ¢å’Œæ ¼å¼åŒ–">è¯·æ±‚å‚æ•°ç±»å‹è½¬æ¢å’Œæ ¼å¼åŒ–</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="/notebook/#æ¥å—è¯·æ±‚å‚æ•°çš„æ–¹å¼">æ¥å—è¯·æ±‚å‚æ•°çš„æ–¹å¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="/notebook/#å¸¸ç”¨ç±»å‹è½¬æ¢æ³¨è§£">å¸¸ç”¨ç±»å‹è½¬æ¢æ³¨è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="/notebook/#formatterè½¬æ¢å™¨">Formatterè½¬æ¢å™¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="/notebook/#converterè½¬æ¢å™¨">Converterè½¬æ¢å™¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="/notebook/#conversionservice">ConversionService</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="/notebook/#è¯·æ±‚å‚æ•°æ ¡éªŒä¸ç»“æœå¤„ç†">è¯·æ±‚å‚æ•°æ ¡éªŒä¸ç»“æœå¤„ç†</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="/notebook/#ä½¿ç”¨validation-api">ä½¿ç”¨Validation API</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="/notebook/#å®ç°validatoræ¥å£">å®ç°Validatoræ¥å£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="/notebook/#åˆ†ç»„éªŒè¯-group-validation">åˆ†ç»„éªŒè¯(Group validation)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="/notebook/#è·¨å­—æ®µéªŒè¯-cross-field-validation">è·¨å­—æ®µéªŒè¯(Cross-field validation)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="/notebook/#ä½¿ç”¨aopè¿›è¡Œå‚æ•°æ ¡éªŒ">ä½¿ç”¨AOPè¿›è¡Œå‚æ•°æ ¡éªŒ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="/notebook/#å‚æ•°æ ¡éªŒç¤ºä¾‹ä¸ç»“æœå¤„ç†">å‚æ•°æ ¡éªŒç¤ºä¾‹ä¸ç»“æœå¤„ç†</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="/notebook/#è¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨çš„åº”ç”¨">è¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨çš„åº”ç”¨</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="/notebook/#è¿‡æ»¤å™¨-filter">è¿‡æ»¤å™¨ï¼ˆFilterï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="/notebook/#æ‹¦æˆªå™¨-interceptor">æ‹¦æˆªå™¨ï¼ˆInterceptorï¼‰</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!--[--><!----><!--]--><div class="theme-hope-content"><h2 id="controllerå’Œhandler" tabindex="-1"><a class="header-anchor" href="#controllerå’Œhandler"><span>Controllerå’ŒHandler</span></a></h2><p>åœ¨Spring MVCæ¡†æ¶ä¸­ï¼ŒControlleræ˜¯MVCæ¶æ„ä¸­çš„â€œCâ€éƒ¨åˆ†ï¼Œå³æ§åˆ¶å™¨ã€‚å®ƒæ˜¯ä¸€ä¸ªç”¨æ¥æ¥æ”¶HTTPè¯·æ±‚çš„ç»„ä»¶ï¼Œå¤„ç†ç”¨æˆ·çš„è¾“å…¥ï¼Œä¸ºç”¨æˆ·è¯·æ±‚æ‰§è¡Œé€‚å½“çš„ä¸šåŠ¡é€»è¾‘ï¼Œå¹¶è¿”å›ç›¸åº”çš„è§†å›¾ç»™ç”¨æˆ·ã€‚ä»¥ä¸‹æ˜¯Controllerçš„ä¸€äº›å…³é”®ç‰¹ç‚¹ï¼š</p><ol><li><p><strong>æ§åˆ¶å™¨çš„è§’è‰²å’ŒèŒè´£ï¼š</strong></p><ul><li><strong>è¯·æ±‚æ˜ å°„ï¼š</strong> åˆ©ç”¨<code>@RequestMapping</code>æˆ–è€…å…·ä½“çš„æ˜ å°„æ³¨è§£ï¼ˆå¦‚<code>@GetMapping</code>ï¼Œ<code>@PostMapping</code>ç­‰ï¼‰ï¼Œå°†ç‰¹å®šçš„è¯·æ±‚è·¯å¾„æ˜ å°„åˆ°æ§åˆ¶å™¨çš„æ–¹æ³•ä¸Šã€‚</li><li><strong>è¯·æ±‚å¤„ç†ï¼š</strong> æ¥å—ç”¨æˆ·çš„è¾“å…¥æ•°æ®ï¼Œè°ƒç”¨ä¸šåŠ¡å±‚ä»£ç å¤„ç†ç”¨æˆ·è¯·æ±‚ã€‚</li><li><strong>æ•°æ®æ¨¡å‹å¡«å……ï¼š</strong> å°†ä¸šåŠ¡å¤„ç†çš„ç»“æœæ”¾å…¥æ¨¡å‹ä¸­ï¼Œæ¨¡å‹æ•°æ®å¯ä»¥ç›´æ¥è¿”å›æˆ–è€…é€šè¿‡<code>ModelAndView</code>å¯¹è±¡ä¼ é€’ç»™è§†å›¾ã€‚</li><li><strong>è§†å›¾é€‰æ‹©ï¼š</strong> å†³å®šè¿”å›ç»™ç”¨æˆ·çš„è§†å›¾åç§°ï¼Œå¯ä»¥æ˜¯é‡å®šå‘ã€è½¬å‘ï¼Œæˆ–è¿”å›ä¸€ä¸ªå…·ä½“è§†å›¾çš„åç§°ã€‚</li><li><strong>å¼‚å¸¸å¤„ç†ï¼š</strong> æ§åˆ¶å™¨å¯ä»¥æœ‰è‡ªå·±çš„å¼‚å¸¸å¤„ç†é€»è¾‘ï¼Œæˆ–è€…é€šè¿‡ <code>@ExceptionHandler</code> æ³¨è§£å¤„ç†ç‰¹å®šå¼‚å¸¸ã€‚</li></ul></li><li><p><strong>å®šä¹‰æ§åˆ¶å™¨ç»„ä»¶ï¼š</strong><br> åœ¨Spring MVCä¸­ï¼Œé€šè¿‡<code>@Controller</code>æ³¨è§£æ¥å®šä¹‰ä¸€ä¸ªæ§åˆ¶å™¨ã€‚æ­¤æ³¨è§£è¡¨æ˜è¢«æ ‡æ³¨çš„ç±»æ˜¯ä¸€ä¸ªSpringç»„ä»¶ï¼Œå¹¶ä¸”å°†å®ƒä½œä¸ºæ§åˆ¶å™¨æ³¨å†Œè‡³Springä¸Šä¸‹æ–‡ä¸­ã€‚</p></li><li><p><strong>è¯·æ±‚å¤„ç†æ–¹æ³•ï¼š</strong><br> æ§åˆ¶å™¨å†…éƒ¨çš„æ–¹æ³•ä¼šé€šè¿‡æ³¨è§£æ¥æ˜ å°„è¯·æ±‚è·¯å¾„ï¼Œå¹¶å¤„ç†å„ç§ç±»å‹çš„è¯·æ±‚å‚æ•°</p></li><li><p><strong>å“åº”å¤„ç†ï¼š</strong><br> æ§åˆ¶å™¨æ–¹æ³•å¯ä»¥ä½¿ç”¨<code>@ResponseBody</code>æ³¨è§£æˆ–è€…è¿”å›<code>ResponseEntity</code>æ¥æä¾›RESTfulé£æ ¼çš„webæœåŠ¡ã€‚å“åº”ä½“é€šå¸¸æ˜¯é€šè¿‡è½¬æ¢å™¨ï¼ˆå¦‚Jacksonåº“ï¼‰è‡ªåŠ¨è½¬æ¢æˆJSONæˆ–XMLã€‚</p></li></ol><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¯ä»¥æ ¹æ®éœ€è¦åˆ›å»ºå¤šä¸ªæ§åˆ¶å™¨ï¼Œæ¯ä¸ªæ§åˆ¶å™¨è´Ÿè´£ç®¡ç†åº”ç”¨ç¨‹åºçš„ä¸åŒéƒ¨åˆ†ã€‚Springæ¡†æ¶æä¾›çš„çµæ´»æ€§è®©å¼€å‘è€…å¯ä»¥å¾ˆå®¹æ˜“åœ°è®¾è®¡å’Œå®ç°æ¸…æ™°çš„REST APIå’ŒWebé¡µé¢æ§åˆ¶é€»è¾‘ã€‚</p><h3 id="ä¼ ç»Ÿservletå¼€å‘æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#ä¼ ç»Ÿservletå¼€å‘æ¨¡å¼"><span>ä¼ ç»ŸServletå¼€å‘æ¨¡å¼</span></a></h3><p>åœ¨Spring MVCæ¡†æ¶ä¸­ï¼Œè™½ç„¶æ³¨è§£æ–¹å¼æä¾›äº†ä¾¿åˆ©å’Œå¼ºå¤§çš„ç¼–ç¨‹æ¨¡å‹ï¼Œä½†æœ‰æ—¶å€™å¼€å‘è€…å¯èƒ½éœ€è¦å›é€€åˆ°æ›´åº•å±‚çš„Servlet APIã€‚Spring MVC é€šè¿‡ä¸åº•å±‚çš„Servlet APIçš„å…¼å®¹æ€§ä½¿è¿™æˆä¸ºå¯èƒ½ã€‚ä¸‹é¢æ˜¯ä¸€äº›è·å–è¯·æ±‚å‚æ•°å’Œè¿”å›å“åº”çš„ä¼ ç»ŸServletæ–¹å¼ï¼š</p><ol><li><p><strong>HttpServletRequest å’Œ HttpServletResponse</strong><br> ä¼ ç»Ÿçš„Servlet API ä¸­çš„ <code>HttpServletRequest</code> å’Œ <code>HttpServletResponse</code> åœ¨Spring MVCæ§åˆ¶å™¨ä¸­ä»ç„¶æ˜¯å¯ä»¥ä½¿ç”¨çš„ã€‚è¿™å…è®¸å¼€å‘è€…ç›´æ¥æ“ä½œè¯·æ±‚å’Œå“åº”å¯¹è±¡ã€‚</p><p>ç¤ºä¾‹è·å–å‚æ•°ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/greet&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">greet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> name <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>name <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        name <span class="token operator">=</span> <span class="token string">&quot;World&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, &quot;</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>HttpSession</strong><br> åŒæ ·ï¼Œå¯ä»¥ç›´æ¥æ“ä½œ <code>HttpSession</code> å¯¹è±¡æ¥ç®¡ç†ä¼šè¯æ•°æ®ã€‚</p><p>ç¤ºä¾‹æ“ä½œä¼šè¯ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/session&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getSessionData</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">HttpSession</span> session <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> data <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> session<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>è·å–è¯·æ±‚å¤´ä¿¡æ¯</strong><br> ç›´æ¥ä» <code>HttpServletRequest</code> è·å–è¯·æ±‚å¤´ä¿¡æ¯ã€‚</p><p>ç¤ºä¾‹è·å–è¯·æ±‚å¤´ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/headerInfo&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">displayHeaderInfo</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> host <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Host&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Host: &quot;</span> <span class="token operator">+</span> host<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>è·å–Cookieä¿¡æ¯</strong><br> Servlet API å…è®¸ç›´æ¥ä» <code>HttpServletRequest</code> è¯»å– cookiesã€‚</p><p>ç¤ºä¾‹è¯»å–Cookieï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/cookieInfo&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">readCookie</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">Cookie</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cookies <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getCookies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>cookies <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Cookie</span> cookie <span class="token operator">:</span> cookies<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>cookie<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; : &quot;</span> <span class="token operator">+</span> cookie<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>è¿”å›å“åº”å†…å®¹</strong><br> ä½¿ç”¨ <code>HttpServletResponse</code> ç›´æ¥æ“ä½œå“åº”å†…å®¹ï¼ŒåŒ…æ‹¬è®¾ç½®çŠ¶æ€ç ã€ç¼–å†™å“åº”ä½“ç­‰ã€‚</p><p>ç¤ºä¾‹å†™å…¥å“åº”ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/submitData&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">submitData</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¤„ç†è¯·æ±‚æ•°æ®...</span>
    response<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">.</span><span class="token constant">SC_CREATED</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è®¾ç½®çŠ¶æ€ç ä¸º201</span>
    response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Data created successfully&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå³ä½¿åœ¨æ³¨è§£é©±åŠ¨çš„Spring MVCç¨‹åºä¸­ï¼Œå¼€å‘è€…ä¹Ÿå¯ä»¥ä½¿ç”¨ServletåŸç”Ÿçš„APIæ¥å¤„ç†HTTPè¯·æ±‚å’Œå“åº”ã€‚è™½ç„¶è¿™ä¸æ˜¯å¸¸ç”¨çš„åšæ³•ï¼Œå› ä¸ºå®ƒå¯¹æµ‹è¯•å’Œæ¨¡æ‹Ÿä¸å¤Ÿå‹å¥½ï¼Œä½†åœ¨ä¸€äº›ç‰¹æ®Šåœºæ™¯ä¸‹å¯èƒ½éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚å¤„ç†éæ ‡å‡†çš„HTTPæ“ä½œæˆ–è€…ä½¿ç”¨äº†ç‰¹æ®ŠServlet APIç‰¹æ€§çš„æƒ…å½¢ã€‚</p><h3 id="è¯·æ±‚å¤„ç†æ–¹æ³•ç›¸å…³æ³¨è§£" tabindex="-1"><a class="header-anchor" href="#è¯·æ±‚å¤„ç†æ–¹æ³•ç›¸å…³æ³¨è§£"><span>è¯·æ±‚å¤„ç†æ–¹æ³•ç›¸å…³æ³¨è§£</span></a></h3><ol><li><p><strong>@RequestMapping</strong><br><code>@RequestMapping</code>æ³¨è§£æ˜¯æœ€åŸºç¡€çš„è¯·æ±‚æ˜ å°„æ³¨è§£ï¼Œé€šè¿‡å…¶å±æ€§æ¥å®šä¹‰è¯·æ±‚çš„ç±»å‹ã€è·¯å¾„ã€å‚æ•°ã€å¤´ä¿¡æ¯ä»¥åŠå…¶ä»–è¯·æ±‚é™åˆ¶æ¡ä»¶ã€‚å®ƒå¯ä»¥ç”¨åœ¨ç±»æˆ–æ–¹æ³•ä¸Šã€‚ç¤ºä¾‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/users&quot;</span><span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token class-name">RequestMethod</span><span class="token punctuation">.</span><span class="token constant">GET</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">listUsers</span><span class="token punctuation">(</span><span class="token class-name">Model</span> model<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>@GetMapping, @PostMapping, @PutMapping, @DeleteMapping, @PatchMapping</strong><br> è¿™äº›æ³¨è§£æ˜¯<code>@RequestMapping</code>çš„ç‰¹å®šå¿«æ·å½¢å¼ï¼Œåˆ†åˆ«ç”¨äºå¤„ç†HTTPçš„GET, POST, PUT, DELETE, PATCHè¯·æ±‚ã€‚å®ƒä»¬åªèƒ½åº”ç”¨äºæ–¹æ³•ä¸Šã€‚ç¤ºä¾‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getUsers</span><span class="token punctuation">(</span><span class="token class-name">Model</span> model<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">addUser</span><span class="token punctuation">(</span><span class="token annotation punctuation">@ModelAttribute</span> <span class="token class-name">User</span> user<span class="token punctuation">,</span> <span class="token class-name">Model</span> model<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h3 id="è¯·æ±‚å‚æ•°ç›¸å…³æ³¨è§£" tabindex="-1"><a class="header-anchor" href="#è¯·æ±‚å‚æ•°ç›¸å…³æ³¨è§£"><span>è¯·æ±‚å‚æ•°ç›¸å…³æ³¨è§£</span></a></h3><p><strong>è¯·æ±‚å‚æ•°ç»‘å®šçš„æ³¨è§£ï¼š</strong></p><ul><li><strong>@RequestParam</strong> - ç”¨äºè®¿é—®è¯·æ±‚å‚æ•°çš„å€¼ï¼ˆå³æŸ¥è¯¢å­—ç¬¦ä¸²æˆ–è¡¨å•å‚æ•°ï¼‰ã€‚ç¤ºä¾‹ï¼š<div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/greet&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">greet</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> required <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span> defaultValue <span class="token operator">=</span> <span class="token string">&quot;World&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><strong>@PathVariable</strong> - ç”¨äºè®¿é—®URIä¸­çš„å˜é‡ã€‚ç¤ºä¾‹ï¼š<div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/users/{id}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getUser</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">,</span> <span class="token class-name">Model</span> model<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><strong>@RequestBody</strong> - ç”¨äºè®¿é—®è¯·æ±‚ä½“çš„å†…å®¹ï¼Œé€šå¸¸ç”¨äºæ¥æ”¶ <mark>JSONæˆ–XMLæ ¼å¼</mark> çš„æ•°æ®ã€‚ç¤ºä¾‹ï¼š<div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">createUser</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><strong>@RequestHeader</strong> - ç”¨äºè®¿é—®è¯·æ±‚å¤´ä¸­çš„ç‰¹å®šå±æ€§ã€‚ç¤ºä¾‹ï¼š<div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/check&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">checkHeader</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestHeader</span><span class="token punctuation">(</span><span class="token string">&quot;User-Agent&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> userAgent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><strong>@CookieValue</strong> - ç”¨äºè®¿é—®Cookieä¸­çš„å€¼ã€‚ç¤ºä¾‹ï¼š<div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/prefs&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getPreferences</span><span class="token punctuation">(</span><span class="token annotation punctuation">@CookieValue</span><span class="token punctuation">(</span><span class="token string">&quot;theme&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> theme<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><strong>@ModelAttribute</strong> - ç”¨äºä» <mark>è¡¨å•</mark> æäº¤çš„æ•°æ®ä¸­ï¼ŒæŠŠè¯·æ±‚å‚æ•°ç»‘å®šåˆ°ä¸€ä¸ªå¯¹è±¡ä¸Šã€‚ç¤ºä¾‹ï¼š<div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">submit</span><span class="token punctuation">(</span><span class="token annotation punctuation">@ModelAttribute</span> <span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="uriè·¯å¾„æ˜ å°„è§„åˆ™" tabindex="-1"><a class="header-anchor" href="#uriè·¯å¾„æ˜ å°„è§„åˆ™"><span>URIè·¯å¾„æ˜ å°„è§„åˆ™</span></a></h3><p>åœ¨Spring MVCä¸­ï¼Œ<code>@RequestMapping</code>æ³¨è§£ï¼ˆä»¥åŠæ´¾ç”Ÿçš„å¿«æ·æ˜ å°„æ³¨è§£ï¼Œå¦‚<code>@GetMapping</code>ã€<code>@PostMapping</code>ç­‰ï¼‰çš„<code>value</code>å±æ€§ç”¨äºå°†æ§åˆ¶å™¨ä¸­çš„æ–¹æ³•ä¸HTTPè¯·æ±‚çš„URLè·¯å¾„è¿›è¡Œæ˜ å°„ã€‚äº†è§£è¿™ä¸ªæ˜ å°„çš„è§„åˆ™å’Œæ³¨æ„äº‹é¡¹å¯¹äºç¼–å†™å¯ç»´æŠ¤å’Œæ˜“ç†è§£çš„ä»£ç è‡³å…³é‡è¦ã€‚</p><p>ä¸‹é¢è¯¦ç»†è§£é‡Š<code>value</code>å±æ€§çš„è§„åˆ™å’Œåº”æ³¨æ„çš„äº‹é¡¹ï¼š</p><ol><li><p><strong>åŸºæœ¬æ˜ å°„ï¼š</strong><br><code>value</code>å±æ€§å®šä¹‰äº†æ–¹æ³•å¤„ç†çš„è¯·æ±‚URIçš„æ¨¡å¼ã€‚ URIæ¨¡å¼å¯ä»¥æ˜¯ç²¾ç¡®çš„å­—ç¬¦ä¸²æˆ–å¸¦æœ‰é€šé…ç¬¦çš„æ¨¡å¼ã€‚</p><p>ç¤ºä¾‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/home&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">home</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;home&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„ä¾‹å­å°†ä¼šåŒ¹é…å‡†ç¡®è·¯å¾„<code>/home</code>çš„GETè¯·æ±‚ã€‚</p></li><li><p><strong>é€šé…ç¬¦ï¼š</strong></p><ul><li><code>*</code>ä»£è¡¨ä»»æ„æ•°é‡çš„å­—ç¬¦ã€‚</li><li><code>**</code>ä»£è¡¨ä»»æ„æ•°é‡çš„ç›®å½•ã€‚</li></ul><p>ç¤ºä¾‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/files/*&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getFiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ä¼šåŒ¹é… /files/x, /files/y ç­‰è·¯å¾„</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/docs/**&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getDocs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ä¼šåŒ¹é… /docs/x, /docs/x/y, /docs/x/y/z ç­‰è·¯å¾„</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>è·¯å¾„å˜é‡ï¼š</strong><br> èŠ±æ‹¬å·<code>{}</code>ä¸­çš„å†…å®¹è¡¨ç¤ºè·¯å¾„å˜é‡ï¼Œå¯å°†æŸæ®µURIæ˜ å°„åˆ°æ–¹æ³•çš„å‚æ•°ä¸Šã€‚</p><p>ç¤ºä¾‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/users/{userId}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getUser</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;userId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> userId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„ä¾‹å­ä¼šå°†URIä¸­<code>/users/1</code>çš„<code>1</code>éƒ¨åˆ†æ³¨å…¥æ–¹æ³•çš„<code>userId</code>å‚æ•°ä¸­ã€‚</p></li><li><p><strong>æ­£åˆ™è¡¨è¾¾å¼ï¼š</strong><br><code>@RequestMapping</code>æ”¯æŒåœ¨è·¯å¾„å˜é‡ä¸­ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥è¿›ä¸€æ­¥é™åˆ¶åŒ¹é…ã€‚</p><p>ç¤ºä¾‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/files/{filename:.+}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Resource</span><span class="token punctuation">&gt;</span></span> <span class="token function">downloadFile</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">String</span> filename<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­£åˆ™è¡¨è¾¾å¼<code>.+</code>ç¡®ä¿<code>filename</code>å¯ä»¥åŒ…æ‹¬ç‚¹ï¼ˆ<code>.</code>ï¼‰åçš„æ–‡ä»¶æ‰©å±•åã€‚</p></li></ol><div class="hint-container tip"><p class="hint-container-title">æ³¨æ„äº‹é¡¹</p><ul><li><strong>è·¯å¾„å”¯ä¸€æ€§ï¼š</strong> ç¡®ä¿ä¸åŒçš„æ§åˆ¶å™¨æ–¹æ³•ä¸è¦æ˜ å°„åˆ°ç›¸åŒçš„è·¯å¾„ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´æ„å¤–çš„è¡Œä¸ºã€‚</li><li><strong>å°¾æ–œæ ï¼š</strong> é»˜è®¤æƒ…å†µä¸‹ï¼ŒSpring MVCå¯¹äºURLè·¯å¾„æœ«å°¾çš„æ–œæ æ˜¯æœ‰åŒºåˆ«çš„ã€‚ä½ å¯ä»¥é€šè¿‡é…ç½®æ¥æ”¹å˜è¿™ä¸ªè¡Œä¸ºã€‚</li><li><strong>è·¯å¾„å‰ç¼€ï¼š</strong> å¦‚æœåœ¨æ§åˆ¶å™¨ç±»çº§åˆ«ä¹Ÿä½¿ç”¨äº†<code>@RequestMapping</code>ï¼Œé‚£ä¹ˆç±»çº§åˆ«çš„è·¯å¾„ä¼šä½œä¸ºè¯¥æ§åˆ¶å™¨ä¸­æ‰€æœ‰æ–¹æ³•çš„å‰ç¼€ã€‚</li><li><strong>åˆç†ç»„ç»‡ï¼š</strong> ä¸ºäº†å¢å¼ºä»£ç çš„å¯ç†è§£æ€§ï¼Œå»ºè®®å°†ç›¸å…³åŠŸèƒ½çš„å¤„ç†æ–¹æ³•ç»„ç»‡åœ¨åŒä¸€ä¸ªæ§åˆ¶å™¨ä¸­ï¼Œå¹¶é€šè¿‡è·¯å¾„åæ˜ å®ƒä»¬ä¹‹é—´çš„å…³ç³»ã€‚</li><li><strong>é¿å…ä¸é™æ€èµ„æºå†²çªï¼š</strong> ç¡®ä¿æ˜ å°„çš„è·¯å¾„ä¸è¦ä¸åº”ç”¨ä¸­ä½¿ç”¨çš„é™æ€èµ„æºçš„è·¯å¾„ç›¸å†²çªï¼Œä¾‹å¦‚ <code>/images</code>, <code>/js</code>, <code>/css</code> ç­‰è·¯å¾„ã€‚</li></ul></div><p>é€šè¿‡åˆç†åˆ©ç”¨<code>value</code>å±æ€§åŠå…¶é€šé…ç¬¦å’Œå˜é‡ï¼Œå¼€å‘è€…å¯ä»¥åˆ›å»ºçµæ´»ä¸”å¼ºå¤§çš„URLè·¯å¾„æ˜ å°„è§„åˆ™ï¼Œæ ¹æ®é¡¹ç›®ç»“æ„å’Œéœ€æ±‚è®¾è®¡å‡ºæ¸…æ™°å’Œç»“æ„åŒ–çš„URLæ¨¡å¼ã€‚è¿™æ˜¯æœ‰æ•ˆç»„ç»‡Spring MVCæ§åˆ¶å™¨çš„å…³é”®éƒ¨åˆ†ï¼Œæœ‰åŠ©äºä¿è¯åº”ç”¨ç¨‹åºçš„æ¸…æ™°æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p><h3 id="å“åº”è§†å›¾æˆ–jsonæ•°æ®" tabindex="-1"><a class="header-anchor" href="#å“åº”è§†å›¾æˆ–jsonæ•°æ®"><span>å“åº”è§†å›¾æˆ–Jsonæ•°æ®</span></a></h3><ol><li>è¿”å›è§†å›¾ï¼ˆä¾‹å¦‚JSPé¡µé¢ï¼‰</li></ol><p>ä¸ºäº†è¿”å›ä¸€ä¸ªè§†å›¾ï¼Œä½ éœ€è¦åˆ›å»ºä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒçš„è¿”å›ç±»å‹ä¸º<code>String</code>ï¼Œå®ƒè¿”å›è§†å›¾åç§°ï¼Œå¹¶ä¸”é€šå¸¸ä½¿ç”¨<code>@RequestMapping</code>æˆ–å…¶ä¸€ç§å˜ä½“<code>@GetMapping</code>ã€<code>@PostMapping</code>ç­‰æ³¨è§£æ ‡æ³¨ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Controller</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyViewController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/greeting&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">greeting</span><span class="token punctuation">(</span><span class="token class-name">Model</span> model<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Hello, World!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;greeting&quot;</span><span class="token punctuation">;</span> <span class="token comment">// è¿”å›çš„æ˜¯viewçš„åç§°ï¼Œé»˜è®¤è·¯å¾„æ˜¯src/main/resources/templates/greeting.html</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½ çš„è§†å›¾æ–‡ä»¶ï¼ˆå¦‚<code>greeting.jsp</code>ï¼‰å¯èƒ½ä½äº<code>/WEB-INF/views/</code>ï¼ˆè¿™æ˜¯ä¸€ä¸ªå¸¸è§çš„ä½ç½®ï¼‰ï¼Œå¹¶åŒ…å«ç”¨äºæ˜¾ç¤ºä¿¡æ¯çš„ä»£ç ã€‚</p><div class="language-html line-numbers-mode" data-ext="html" data-title="html"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Greeting Page<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>${message}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>è¿”å›JSONæ•°æ®</li></ol><p>ç›¸åï¼Œå¦‚æœä½ æƒ³è¿”å›JSONæ•°æ®ï¼Œéœ€è¦ä½¿ç”¨<code>@RestController</code>æ³¨è§£æˆ–è€…åœ¨æ–¹æ³•ä¸Šä½¿ç”¨<code>@ResponseBody</code>æ³¨è§£ã€‚ç„¶åè¿”å›ä¸€ä¸ªå¯¹è±¡æˆ–è€…é›†åˆç±»å‹çš„æ•°æ®ï¼ŒSpringå°†è‡ªåŠ¨ä½¿ç”¨Jacksonè¿™æ ·çš„åº“è¿›è¡Œåºåˆ—åŒ–åˆ°JSONã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyDataController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/data&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">MyData</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">MyData</span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        data<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        data<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;John Doe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> data<span class="token punctuation">;</span> <span class="token comment">// å¯¹è±¡å°†è‡ªåŠ¨è½¬æ¢ä¸ºJSONæ ¼å¼</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ç®€å•çš„POJOç±»</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">MyData</span> <span class="token punctuation">{</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
        <span class="token comment">// çœç•¥getterå’Œsetter</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="restful-webæœåŠ¡" tabindex="-1"><a class="header-anchor" href="#restful-webæœåŠ¡"><span>RESTful WebæœåŠ¡</span></a></h3><p>RESTfulï¼ˆRepresentational State Transferï¼‰æ˜¯ä¸€ç§è½¯ä»¶æ¶æ„é£æ ¼ï¼Œå®ƒå®šä¹‰äº†ä¸€ç»„çº¦æŸå’ŒåŸåˆ™ï¼Œç”¨äºåˆ›å»ºWebæœåŠ¡ã€‚RESTfulæœåŠ¡ä½¿ç”¨HTTPåè®®çš„æ ‡å‡†æ–¹æ³•ï¼ˆå¦‚GETã€POSTã€PUTã€DELETEç­‰ï¼‰å¯¹èµ„æºè¿›è¡Œæ“ä½œï¼Œé€šå¸¸ä»¥JSONæˆ–XMLçš„å½¢å¼è¿›è¡Œæ•°æ®äº¤æ¢ã€‚å€ŸåŠ©äºå…¶ç®€å•ã€è½»é‡ã€æ˜“äºç†è§£å’Œå®ç°çš„ç‰¹ç‚¹ï¼ŒRESTfulæœåŠ¡æˆä¸ºæ„å»ºWebåº”ç”¨ç¨‹åºä¸­éå¸¸æµè¡Œçš„ä¸€ç§æ–¹å¼ã€‚</p><p>RESTfulæœåŠ¡çš„åŸºæœ¬åŸåˆ™</p><ol><li><strong>èµ„æºçš„æ ‡è¯†</strong>ï¼šåœ¨RESTæ¶æ„ä¸­ï¼Œæ‰€æœ‰çš„ä¸œè¥¿éƒ½è¢«è§†ä¸ºèµ„æºï¼Œæ¯ä¸ªèµ„æºéƒ½è¢«ä¸€ä¸ªURIï¼ˆç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼‰æ‰€å”¯ä¸€æ ‡è¯†ã€‚</li><li><strong>æ— çŠ¶æ€æ€§</strong>ï¼šæ¯ä¸ªè¯·æ±‚ä»å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨å¿…é¡»åŒ…å«æ‰€æœ‰å¿…è¦çš„ä¿¡æ¯æ¥ç†è§£å’Œå¤„ç†è¯·æ±‚ã€‚æœåŠ¡å™¨ä¸ä¼šå­˜å‚¨ä»»ä½•å®¢æˆ·ç«¯è¯·æ±‚çš„çŠ¶æ€ä¿¡æ¯ã€‚</li><li><strong>å¯ç¼“å­˜</strong>ï¼šæœåŠ¡å™¨å“åº”çš„æ•°æ®åº”è¯¥æ ‡æ˜è‡ªå·±æ˜¯å¦å¯ä»¥è¢«ç¼“å­˜ã€‚</li><li><strong>ç»Ÿä¸€æ¥å£</strong>ï¼šRESTæœåŠ¡é€šè¿‡ç»Ÿä¸€å’Œé¢„å®šä¹‰çš„æ¥å£æ“ä½œèµ„æºï¼Œä¾‹å¦‚ä½¿ç”¨HTTPæ ‡å‡†æ–¹æ³•ã€‚</li><li><strong>åˆ†å±‚ç³»ç»Ÿ</strong>ï¼šRESTå…è®¸ä½ ä½¿ç”¨åˆ†å±‚çš„ç³»ç»Ÿæ¶æ„ï¼Œæ¯ä¸€å±‚åªçŸ¥é“ä¸ä¹‹ç›¸é‚»çš„ä¸€å±‚ã€‚</li></ol><p>RESTful WebæœåŠ¡çš„HTTPæ–¹æ³•</p><ul><li><strong>GET</strong>ï¼šè·å–èµ„æºã€‚</li><li><strong>POST</strong>ï¼šåˆ›å»ºæ–°èµ„æºã€‚</li><li><strong>PUT</strong>ï¼šæ›´æ–°å·²æœ‰èµ„æºã€‚</li><li><strong>DELETE</strong>ï¼šåˆ é™¤èµ„æºã€‚</li></ul><p>å‡è®¾æˆ‘ä»¬åœ¨å¼€å‘ä¸€ä¸ªç”¨æˆ·ç®¡ç†ç³»ç»Ÿçš„RESTful WebæœåŠ¡ï¼Œç”¨æˆ·èµ„æºå¯ä»¥ç”¨CRUDï¼ˆåˆ›å»ºã€è¯»å–ã€æ›´æ–°ã€åˆ é™¤ï¼‰æ“ä½œè¿›è¡Œç®¡ç†ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨Spring Bootæ¥åˆ›å»ºè¿™æ ·ä¸€ä¸ªæœåŠ¡çš„ä¸€ä¸ªç¤ºä¾‹ï¼š</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ª<code>User</code>ç±»æ¥è¡¨ç¤ºç”¨æˆ·èµ„æºï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span>
    <span class="token comment">// çœç•¥æ„é€ å‡½æ•°ã€getterå’Œsetteræ–¹æ³•</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª<code>UserController</code>ç±»æ¥å¤„ç†å…³äºç”¨æˆ·èµ„æºçš„HTTPè¯·æ±‚ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/api/users&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> users <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// è·å–æ‰€æœ‰ç”¨æˆ·</span>
    <span class="token annotation punctuation">@GetMapping</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">getAllUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>users<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// é€šè¿‡IDè·å–å•ä¸ªç”¨æˆ·</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">getUserById</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> users<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> user <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">notFound</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// åˆ›å»ºæ–°ç”¨æˆ·</span>
    <span class="token annotation punctuation">@PostMapping</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">createUser</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        users<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token class-name">HttpStatus</span><span class="token punctuation">.</span><span class="token constant">CREATED</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// æ›´æ–°ç”¨æˆ·</span>
    <span class="token annotation punctuation">@PutMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">updateUser</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> id<span class="token punctuation">,</span> <span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        users<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// åˆ é™¤ç”¨æˆ·</span>
    <span class="token annotation punctuation">@DeleteMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">deleteUser</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        users<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>UserController</code>ç±»å®šä¹‰äº†äº”ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«å¯¹åº”äºç”¨æˆ·èµ„æºçš„CRUDæ“ä½œä»¥åŠè·å–æ‰€æœ‰ç”¨æˆ·çš„æ“ä½œã€‚è¿™äº›æ–¹æ³•é€šè¿‡<code>@RestController</code>å’Œ<code>@RequestMapping</code>æ³¨è§£ä¸ç›¸åº”çš„HTTPè¯·æ±‚ç»‘å®šã€‚æ¯ä¸ªæ–¹æ³•éƒ½ä½¿ç”¨é€‚å½“çš„HTTPæ–¹æ³•æ³¨è§£ï¼ˆå¦‚<code>@GetMapping</code>ã€<code>@PostMapping</code>ç­‰ï¼‰æ¥å¤„ç†ç‰¹å®šç±»å‹çš„è¯·æ±‚ï¼Œå¹¶é€šè¿‡è¿”å›<code>ResponseEntity</code>æ¥å°è£…HTTPå“åº”ã€‚</p><p>é€šè¿‡éµå¾ªRESTæ¶æ„åŸåˆ™å’Œä½¿ç”¨Spring Bootè¿™æ ·çš„ç°ä»£æ¡†æ¶ï¼Œå¼€å‘äººå‘˜å¯ä»¥ç›¸å¯¹å®¹æ˜“åœ°åˆ›å»ºé«˜æ•ˆã€å¯æ‰©å±•çš„WebæœåŠ¡ã€‚ä¸Šé¢çš„ç¤ºä¾‹ä»…å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨Spring Bootæ¥ç®€å•åœ°å®ç°ä¸€ä¸ªRESTfulæœåŠ¡ï¼Œå®é™…åº”ç”¨ä¸­ï¼ŒæœåŠ¡çš„å®ç°å¯èƒ½éœ€è¦å¤„ç†æ›´å¤æ‚çš„ä¸šåŠ¡é€»è¾‘ã€æ•°æ®éªŒè¯ã€å¼‚å¸¸å¤„ç†ã€å®‰å…¨æ€§ç­‰æ–¹é¢çš„è€ƒè™‘ã€‚</p><h2 id="è¯·æ±‚å‚æ•°ç±»å‹è½¬æ¢å’Œæ ¼å¼åŒ–" tabindex="-1"><a class="header-anchor" href="#è¯·æ±‚å‚æ•°ç±»å‹è½¬æ¢å’Œæ ¼å¼åŒ–"><span>è¯·æ±‚å‚æ•°ç±»å‹è½¬æ¢å’Œæ ¼å¼åŒ–</span></a></h2><h3 id="æ¥å—è¯·æ±‚å‚æ•°çš„æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#æ¥å—è¯·æ±‚å‚æ•°çš„æ–¹å¼"><span>æ¥å—è¯·æ±‚å‚æ•°çš„æ–¹å¼</span></a></h3><h4 id="_1-è·¯å¾„å˜é‡-path-variables" tabindex="-1"><a class="header-anchor" href="#_1-è·¯å¾„å˜é‡-path-variables"><span>1. è·¯å¾„å˜é‡ï¼ˆPath Variablesï¼‰</span></a></h4><p><strong>ä½¿ç”¨æ­¥éª¤ï¼š</strong></p><ul><li>åœ¨æ§åˆ¶å™¨æ–¹æ³•ä¸­ä½¿ç”¨<code>@PathVariable</code>æ³¨è§£ç»‘å®šURIæ¨¡æ¿å˜é‡ã€‚</li><li>åœ¨<code>@RequestMapping</code>çš„è·¯å¾„ä¸­ä½¿ç”¨èŠ±æ‹¬å·ï¼ˆ<code>{variable}</code>ï¼‰å®šä¹‰å˜é‡ã€‚</li></ul><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Controller</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getUser</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> userId<span class="token punctuation">,</span> <span class="token class-name">Model</span> model<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å‡è®¾userService.getUserById()ç”¨äºè·å–ç”¨æˆ·</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">getUserById</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;userView&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-è¯·æ±‚å‚æ•°-request-parameters" tabindex="-1"><a class="header-anchor" href="#_2-è¯·æ±‚å‚æ•°-request-parameters"><span>2. è¯·æ±‚å‚æ•°ï¼ˆRequest Parametersï¼‰</span></a></h4><p><strong>ä½¿ç”¨æ­¥éª¤ï¼š</strong></p><ul><li>ä½¿ç”¨<code>@RequestParam</code>æ¥ç»‘å®šå•ä¸ªè¯·æ±‚å‚æ•°ã€‚</li><li>å¯æŒ‡å®šè¯·æ±‚å‚æ•°çš„åç§°ã€æ˜¯å¦å¿…é¡»ä»¥åŠé»˜è®¤å€¼ã€‚</li></ul><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Controller</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProductController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/products&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">searchProducts</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;q&quot;</span><span class="token punctuation">,</span> required <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token class-name">String</span> query<span class="token punctuation">,</span> <span class="token class-name">Model</span> model<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span><span class="token punctuation">&gt;</span></span> products <span class="token operator">=</span> productService<span class="token punctuation">.</span><span class="token function">searchProducts</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
        model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;products&quot;</span><span class="token punctuation">,</span> products<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;productsView&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-è¯·æ±‚ä½“-request-body" tabindex="-1"><a class="header-anchor" href="#_3-è¯·æ±‚ä½“-request-body"><span>3. è¯·æ±‚ä½“ï¼ˆRequest Bodyï¼‰</span></a></h4><p><strong>ä½¿ç”¨æ­¥éª¤ï¼š</strong></p><ul><li>ä½¿ç”¨<code>@RequestBody</code>æ³¨è§£ç»‘å®šè¯·æ±‚ä½“åˆ°æ–¹æ³•å‚æ•°ã€‚</li><li>å¸¸ä¸<code>@PostMapping</code>ç­‰ç”¨äºå¤„ç†HTTP POSTè¯·æ±‚çš„æ˜ å°„æ³¨è§£ä¸€èµ·ä½¿ç”¨ã€‚</li></ul><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Controller</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/orders&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@PostMapping</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">createOrder</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">Order</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Order</span> savedOrder <span class="token operator">=</span> orderService<span class="token punctuation">.</span><span class="token function">saveOrder</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>savedOrder<span class="token punctuation">,</span> <span class="token class-name">HttpStatus</span><span class="token punctuation">.</span><span class="token constant">CREATED</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-è¡¨å•å¯¹è±¡-form-objects" tabindex="-1"><a class="header-anchor" href="#_4-è¡¨å•å¯¹è±¡-form-objects"><span>4. è¡¨å•å¯¹è±¡ï¼ˆForm Objectsï¼‰</span></a></h4><p><strong>ä½¿ç”¨æ­¥éª¤ï¼š</strong></p><ul><li>åˆ›å»ºä¸€ä¸ªJavaBeanç”¨ä½œè¡¨å•çš„æ¨¡å‹ã€‚</li><li>ä½¿ç”¨<code>@ModelAttribute</code>æ³¨è§£æ–¹æ³•å‚æ•°æ¥æ¥æ”¶è¡¨å•å­—æ®µã€‚</li></ul><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Controller</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/registrations&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RegistrationController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@PostMapping</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">submitForm</span><span class="token punctuation">(</span><span class="token annotation punctuation">@ModelAttribute</span> <span class="token class-name">RegistrationForm</span> form<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å¤„ç†è¡¨å•æ•°æ®ï¼Œå¦‚æ³¨å†Œç”¨æˆ·</span>
        registrationService<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>form<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;redirect:/home&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨HTMLä¸­ç›¸åº”è¡¨å•ï¼š</p><div class="language-html line-numbers-mode" data-ext="html" data-title="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>POST<span class="token punctuation">&quot;</span></span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/registrations<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>email<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>email<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Register<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å¸¸ç”¨ç±»å‹è½¬æ¢æ³¨è§£" tabindex="-1"><a class="header-anchor" href="#å¸¸ç”¨ç±»å‹è½¬æ¢æ³¨è§£"><span>å¸¸ç”¨ç±»å‹è½¬æ¢æ³¨è§£</span></a></h3><ol><li><p><strong>@InitBinder</strong></p><ul><li>ç”¨äºè‡ªå®šä¹‰è¯·æ±‚å‚æ•°çš„ç»‘å®šå’ŒéªŒè¯ã€‚</li><li>åœ¨æ§åˆ¶å™¨ä¸­å®šä¹‰å¸¦æœ‰<code>@InitBinder</code>æ³¨è§£çš„æ–¹æ³•æ¥åˆå§‹åŒ–<code>WebDataBinder</code>ã€‚</li><li>å¯ä»¥æ³¨å†Œè‡ªå®šä¹‰çš„ç¼–è¾‘å™¨å’ŒéªŒè¯å™¨ã€‚<br><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></li></ul><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Controller</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@InitBinder</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">initBinder</span><span class="token punctuation">(</span><span class="token class-name">WebDataBinder</span> binder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SimpleDateFormat</span> dateFormat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy-MM-dd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        binder<span class="token punctuation">.</span><span class="token function">registerCustomEditor</span><span class="token punctuation">(</span><span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">CustomDateEditor</span><span class="token punctuation">(</span>dateFormat<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// æ¥æ”¶æ—¥æœŸå‚æ•°çš„æ§åˆ¶å™¨æ–¹æ³•</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>@DateTimeFormat</strong></p><ul><li>ä¸<code>@RequestParam</code>, <code>@PathVariable</code>, <code>@ModelAttribute</code>ç­‰æ³¨è§£ä¸€åŒä½¿ç”¨ï¼ŒæŒ‡å®šæ—¥æœŸ/æ—¶é—´å‚æ•°çš„æ ¼å¼åŒ–æ–¹å¼ã€‚</li><li>å¯ä»¥è‡ªåŠ¨å°†å­—ç¬¦ä¸²è½¬æ¢æˆæ—¥æœŸ/æ—¶é—´ç±»å‹ã€‚<br><strong>ä½¿ç”¨æ­¥éª¤ï¼š</strong></li><li>ä¸ºæ—¥æœŸå­—æ®µæ·»åŠ <code>@DateTimeFormat</code>æ³¨è§£ã€‚</li></ul><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyForm</span> <span class="token punctuation">{</span>
    
    <span class="token annotation punctuation">@DateTimeFormat</span><span class="token punctuation">(</span>pattern <span class="token operator">=</span> <span class="token string">&quot;yyyy-MM-dd&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Date</span> date<span class="token punctuation">;</span>

    <span class="token comment">// çœç•¥äº†å…¶ä»–å­—æ®µå’Œgetter/setteræ–¹æ³•</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Controller</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/submit-form&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">submit</span><span class="token punctuation">(</span><span class="token annotation punctuation">@ModelAttribute</span> <span class="token class-name">MyForm</span> form<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// form.getDate() å°†å·²æ­£ç¡®è½¬æ¢ä¸ºDateç±»å‹</span>
        <span class="token keyword">return</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><div class="hint-container tip"><p class="hint-container-title">åŒºåˆ«å’Œä½¿ç”¨åœºæ™¯</p><ul><li><p><strong>@InitBinderï¼š</strong></p><ul><li>é€šå¸¸ç”¨äºControllerå†…éƒ¨ç‰¹æœ‰çš„æ•°æ®ç»‘å®šå’ŒéªŒè¯éœ€æ±‚ã€‚</li><li>ç”¨äºè‡ªå®šä¹‰WebDataBinderä»¥åº”å¯¹ç‰¹å®šçš„ç»‘å®šç­–ç•¥ï¼Œä¾‹å¦‚æ—¥æœŸå’Œé›†åˆç±»å‹ã€‚</li></ul></li><li><p><strong>@DateTimeFormatï¼š</strong></p><ul><li>ä¸»è¦ç”¨äºæ—¥æœŸå’Œæ—¶é—´ç±»å‹çš„å‚æ•°æ¥æ”¶ã€‚</li><li>å¯ä»¥æŒ‡å®šæ—¥æœŸ/æ—¶é—´çš„æ ¼å¼ï¼Œç®€åŒ–æ—¥æœŸç±»å‹çš„æ•°æ®ç»‘å®šã€‚</li></ul></li><li><p><strong>Formatterå’ŒConverterï¼š</strong></p><ul><li>Formatterä¸€èˆ¬ç”¨äºå¤„ç†æ–‡æœ¬æ•°æ®ä¸ç‰¹å®šå¯¹è±¡ä¹‹é—´çš„æ ¼å¼åŒ–å’Œè§£æã€‚</li><li>Converteré€‚ç”¨äºæ›´å¹¿æ³›çš„ç±»å‹è½¬æ¢æƒ…å†µï¼Œä¸ä»…é™äºå­—ç¬¦ä¸²ã€‚</li><li>Formatteré€šå¸¸ç”¨äºè¡¨å•å’ŒURLå‚æ•°çš„å¤„ç†ï¼Œè€ŒConverteré€‚ç”¨äºAPIå’Œå†…éƒ¨æ•°æ®ä¹‹é—´çš„è½¬æ¢ã€‚</li></ul></li><li><p><strong>ConversionServiceï¼š</strong></p><ul><li>ä½œä¸ºåº”ç”¨ç¨‹åºä¸­æ‰€æœ‰ç±»å‹è½¬æ¢çš„ä¸­å¿ƒæœåŠ¡ã€‚</li><li>å¯ä»¥åœ¨æœåŠ¡å±‚æˆ–å…¶ä»–ç»„ä»¶ä¸­é‡ç”¨å·²ç»æ³¨å†Œçš„Converterå’ŒFormatterã€‚</li></ul></li></ul></div><h3 id="formatterè½¬æ¢å™¨" tabindex="-1"><a class="header-anchor" href="#formatterè½¬æ¢å™¨"><span>Formatterè½¬æ¢å™¨</span></a></h3><ul><li>å®ç°<code>org.springframework.format.Formatter</code>æ¥å£ï¼Œç”¨äºè‡ªå®šä¹‰æ ¼å¼è½¬æ¢è§„åˆ™ã€‚</li><li>é€‚ç”¨äºæ–‡æœ¬å’Œç‰¹å®šå¯¹è±¡ç±»å‹ä¹‹é—´çš„è½¬æ¢ã€‚</li><li>ä¸€æ—¦æ³¨å†Œåˆ°å…¨å±€æ ¼å¼åŒ–å™¨ï¼ˆFormatterRegistryï¼‰ä¸­ï¼Œåœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­å‡å¯ç”¨ã€‚</li></ul><p>åœ¨Spring MVCä¸­ï¼Œä½¿ç”¨<code>Formatter</code>æ¥å£æ¥è½¬æ¢æ—¥æœŸæ ¼å¼æ˜¯ä¸€ç§éå¸¸çµæ´»çš„æ–¹æ³•ï¼Œå®ƒå…è®¸ä½ å°†å­—ç¬¦ä¸²å’Œæ—¥æœŸç±»å‹ä¹‹é—´äº’ç›¸è½¬æ¢ã€‚è¿™åœ¨å¤„ç†è¡¨å•æ•°æ®æˆ–è€…URLå‚æ•°æ—¶å°¤å…¶æœ‰ç”¨ã€‚ä¸‹é¢å°†é€šè¿‡ä¸€ä¸ªä½¿ç”¨<code>Formatter</code>æ¥è½¬æ¢æ—¥æœŸæ ¼å¼çš„ä»£ç ç¤ºä¾‹è¿›è¡Œè¯¦ç»†è¯´æ˜ã€‚</p><p>1). å®šä¹‰ä¸€ä¸ªæ—¥æœŸæ ¼å¼è½¬æ¢å™¨</p><p>é¦–å…ˆï¼Œä½ éœ€è¦å®ç°<code>Formatter</code>æ¥å£æ¥å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰çš„æ—¥æœŸæ ¼å¼è½¬æ¢å™¨ã€‚è¿™ä¸ªè½¬æ¢å™¨èƒ½å¤Ÿå°†å­—ç¬¦ä¸²è½¬æ¢æˆæ—¥æœŸ(<code>parse</code>æ–¹æ³•)å¹¶å°†æ—¥æœŸè½¬æ¢å›å­—ç¬¦ä¸²(<code>print</code>æ–¹æ³•)ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>format<span class="token punctuation">.</span></span><span class="token class-name">Formatter</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span><span class="token class-name">ParseException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span><span class="token class-name">SimpleDateFormat</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Locale</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DateFormatter</span> <span class="token keyword">implements</span> <span class="token class-name">Formatter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Date</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> dateFormatPattern<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">DateFormatter</span><span class="token punctuation">(</span><span class="token class-name">String</span> dateFormatPattern<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dateFormatPattern <span class="token operator">=</span> dateFormatPattern<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token class-name">Date</span> date<span class="token punctuation">,</span> <span class="token class-name">Locale</span> locale<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>date <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span>dateFormatPattern<span class="token punctuation">,</span> locale<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Date</span> <span class="token function">parse</span><span class="token punctuation">(</span><span class="token class-name">String</span> text<span class="token punctuation">,</span> <span class="token class-name">Locale</span> locale<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ParseException</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>text <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> text<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span>dateFormatPattern<span class="token punctuation">,</span> locale<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œ<code>DateFormatter</code>ç±»é€šè¿‡æ„é€ å‡½æ•°æ¥æ”¶ä¸€ä¸ªæ—¥æœŸæ ¼å¼å­—ç¬¦ä¸²(<code>dateFormatPattern</code>)ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å°†ç”¨äº<code>SimpleDateFormat</code>çš„å®ä¾‹åŒ–ã€‚<code>print</code>æ–¹æ³•ç”¨äºå°†<code>Date</code>ç±»å‹è½¬æ¢æˆ<code>String</code>ç±»å‹ï¼Œè€Œ<code>parse</code>æ–¹æ³•åˆ™å°†<code>String</code>ç±»å‹è½¬æ¢æˆ<code>Date</code>ç±»å‹ã€‚</p><p>2). æ³¨å†Œæ—¥æœŸæ ¼å¼è½¬æ¢å™¨</p><p>åœ¨Springé…ç½®ä¸­ï¼Œä½ éœ€è¦å°†ä¸Šè¿°å®šä¹‰çš„æ—¥æœŸæ ¼å¼è½¬æ¢å™¨æ³¨å†Œåˆ°Spring MVCçš„è½¬æ¢æœåŠ¡ä¸­ï¼Œè¿™æ ·Spring MVCå°±èƒ½å¤Ÿè‡ªåŠ¨ä½¿ç”¨è¯¥è½¬æ¢å™¨å°†å­—ç¬¦ä¸²å’Œæ—¥æœŸç±»å‹äº’ç›¸è½¬æ¢äº†ã€‚</p><p>å¦‚æœä½ çš„åº”ç”¨æ˜¯åŸºäºJavaé…ç½®çš„ï¼Œä½ å¯ä»¥é€šè¿‡ä¸€ä¸ªé…ç½®ç±»å®ç°<code>WebMvcConfigurer</code>æ¥å£å¹¶é‡å†™<code>addFormatters</code>æ–¹æ³•æ¥æ³¨å†Œè‡ªå®šä¹‰çš„<code>DateFormatter</code>ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>format<span class="token punctuation">.</span></span><span class="token class-name">FormatterRegistry</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">WebMvcConfigurer</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addFormatters</span><span class="token punctuation">(</span><span class="token class-name">FormatterRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        registry<span class="token punctuation">.</span><span class="token function">addFormatter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DateFormatter</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy-MM-dd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3). ä½¿ç”¨è½¬æ¢å™¨</p><p>ä¸€æ—¦æ³¨å†Œï¼Œä½ å°±å¯ä»¥åœ¨æ§åˆ¶å™¨çš„æ–¹æ³•å‚æ•°ä¸­ä½¿ç”¨<code>@RequestParam</code>ã€<code>@ModelAttribute</code>æˆ–å…¶ä»–ç›¸åº”æ³¨è§£å’Œæ—¥æœŸç±»å‹ä¸€èµ·ä½¿ç”¨ï¼ŒSpring MVCä¼šè‡ªåŠ¨è°ƒç”¨ä½ çš„<code>DateFormatter</code>æ¥å¤„ç†å­—ç¬¦ä¸²å’Œæ—¥æœŸç±»å‹çš„è½¬æ¢ã€‚</p><p>ä¾‹å¦‚ï¼Œåœ¨æäº¤è¡¨å•æ—¶ï¼Œä½ å¯èƒ½æœ‰ä¸€ä¸ª<code>@ModelAttribute</code>å‚æ•°ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/submit&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">handleSubmit</span><span class="token punctuation">(</span><span class="token annotation punctuation">@ModelAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;event&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Event</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ä½¿ç”¨event.getDate()ï¼Œè¿™é‡Œçš„dateå·²ç»è¢«è‡ªåŠ¨è½¬æ¢æˆäº†Dateç±»å‹</span>
    <span class="token comment">// é€»è¾‘å¤„ç†...</span>
    <span class="token keyword">return</span> <span class="token string">&quot;redirect:/success&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>HTMLè¡¨å•ï¼š</p><div class="language-html line-numbers-mode" data-ext="html" data-title="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>post<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>date<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Submit<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè¡¨å•ä¸­çš„<code>date</code>å­—æ®µä¼šè‡ªåŠ¨ä½¿ç”¨æˆ‘ä»¬æ³¨å†Œçš„<code>DateFormatter</code>è½¬æ¢å™¨è¿›è¡Œè½¬æ¢ï¼Œæ— éœ€åœ¨æ§åˆ¶å™¨ä¸­æ‰‹åŠ¨è§£ææ—¥æœŸå­—ç¬¦ä¸²ã€‚</p><h3 id="converterè½¬æ¢å™¨" tabindex="-1"><a class="header-anchor" href="#converterè½¬æ¢å™¨"><span>Converterè½¬æ¢å™¨</span></a></h3><ul><li>å®ç°<code>org.springframework.core.convert.converter.Converter</code>æ¥å£ï¼Œå®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰çš„ç±»å‹è½¬æ¢è§„åˆ™ã€‚</li><li>å½“éœ€è¦å°†ä¸€ç§ç±»å‹è½¬æ¢æˆå¦ä¸€ç§ç±»å‹æ—¶ä½¿ç”¨ã€‚</li></ul><p>1). åˆ›å»ºæ—¥æœŸæ ¼å¼è½¬æ¢å™¨</p><p>é¦–å…ˆï¼Œä½ éœ€è¦åˆ›å»ºä¸€ä¸ªå®ç°äº†<code>Converter</code>æ¥å£çš„ç±»ã€‚åœ¨è¿™ä¸ªç±»é‡Œï¼Œå®šä¹‰å­—ç¬¦ä¸²åˆ°æ—¥æœŸçš„è½¬æ¢é€»è¾‘ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>convert<span class="token punctuation">.</span>converter<span class="token punctuation">.</span></span><span class="token class-name">Converter</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span><span class="token class-name">ParseException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span><span class="token class-name">SimpleDateFormat</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StringToDateConverter</span> <span class="token keyword">implements</span> <span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Date</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> datePattern<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">StringToDateConverter</span><span class="token punctuation">(</span><span class="token class-name">String</span> datePattern<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>datePattern <span class="token operator">=</span> datePattern<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Date</span> <span class="token function">convert</span><span class="token punctuation">(</span><span class="token class-name">String</span> source<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>source <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> source<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">SimpleDateFormat</span> dateFormat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span>datePattern<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> dateFormat<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ParseException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;invalid date format. Please use this pattern\&quot;&quot;</span> 
                <span class="token operator">+</span> datePattern <span class="token operator">+</span> <span class="token string">&quot;\&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ª<code>StringToDateConverter</code>ç±»ä¸­ï¼Œæˆ‘ä»¬æ¥æ”¶ä¸€ä¸ªæ—¥æœŸæ ¼å¼å­—ç¬¦ä¸²ï¼ˆ<code>datePattern</code>ï¼‰ï¼Œå¹¶åœ¨<code>convert</code>æ–¹æ³•ä¸­ä½¿ç”¨å®ƒæ¥è§£æå­—ç¬¦ä¸²ã€‚å¦‚æœè§£æå¤±è´¥ï¼Œå®ƒä¼šæŠ›å‡º<code>IllegalArgumentException</code>å¼‚å¸¸ã€‚</p><p>2). æ³¨å†Œæ—¥æœŸæ ¼å¼è½¬æ¢å™¨</p><p>æ¥ä¸‹æ¥ï¼Œåœ¨Springçš„é…ç½®ç±»ä¸­æ³¨å†Œè¿™ä¸ªè½¬æ¢å™¨ã€‚è¿™å¯ä»¥åœ¨å®ç°äº†<code>WebMvcConfigurer</code>æ¥å£çš„é…ç½®ç±»ä¸­å®Œæˆã€‚é€šè¿‡é‡å†™<code>addFormatters</code>æ–¹æ³•ï¼Œæˆ‘ä»¬å°†è‡ªå®šä¹‰è½¬æ¢å™¨æ·»åŠ åˆ°æ ¼å¼åŒ–æ³¨å†Œæœºåˆ¶ä¸­ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>format<span class="token punctuation">.</span></span><span class="token class-name">FormatterRegistry</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">WebMvcConfigurer</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebMvcConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addFormatters</span><span class="token punctuation">(</span><span class="token class-name">FormatterRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        registry<span class="token punctuation">.</span><span class="token function">addConverter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringToDateConverter</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy-MM-dd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3). ä½¿ç”¨è‡ªå®šä¹‰è½¬æ¢å™¨</p><p>åœ¨æ³¨å†Œäº†è½¬æ¢å™¨ä¹‹åï¼Œä½ å¯ä»¥åœ¨Spring MVCæ§åˆ¶å™¨çš„æ–¹æ³•ä¸­ç›´æ¥ä½¿ç”¨å®ƒã€‚æ— éœ€ä»»ä½•é¢å¤–æ³¨è§£è°ƒç”¨è‡ªå®šä¹‰è½¬æ¢å™¨ï¼ŒSpringä¼šè‡ªåŠ¨ä½¿ç”¨å®ƒã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Controller</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestParam</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>ui<span class="token punctuation">.</span></span><span class="token class-name">Model</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Controller</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EventController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/event&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getEvent</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;date&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Date</span> eventDate<span class="token punctuation">,</span> <span class="token class-name">Model</span> model<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// eventDate å‚æ•°å°†ç”± StringToDateConverter è‡ªåŠ¨è½¬æ¢</span>
        model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;eventDate&quot;</span><span class="token punctuation">,</span> eventDate<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;event&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ ·ï¼Œåœ¨ä½ è°ƒç”¨<code>/event?date=2023-04-05</code>è¿™æ ·çš„URLæ—¶ï¼ŒURLä¸­çš„<code>date</code>å‚æ•°ä¼šè¢«è‡ªåŠ¨è½¬æ¢ä¸º<code>java.util.Date</code>ç±»å‹ï¼Œå¹¶ä¼ é€’ç»™<code>getEvent</code>æ–¹æ³•çš„<code>eventDate</code>å‚æ•°ã€‚</p><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒSpring MVCæ¡†æ¶ä¼šæ‹¦æˆªåˆ°HTTPè¯·æ±‚ï¼Œè§£æ<code>date</code>å‚æ•°ï¼Œå¹¶è°ƒç”¨ä½ çš„<code>StringToDateConverter</code>å°†å…¶è½¬æ¢ä¸º<code>Date</code>å¯¹è±¡ã€‚è¿™ä¸€è¿‡ç¨‹å®Œå…¨è‡ªåŠ¨åŒ–ï¼Œä¸éœ€è¦åœ¨æ§åˆ¶å™¨ä¸­ç¼–å†™ä»»ä½•é¢å¤–çš„è§£æä»£ç ã€‚è¿™ä½¿å¾—åœ¨æ§åˆ¶å™¨é€»è¾‘ä¸­å¤„ç†æ—¥æœŸå˜å¾—æ›´ç®€æ´ã€æ›´ç›´è§‚ã€‚</p><h3 id="conversionservice" tabindex="-1"><a class="header-anchor" href="#conversionservice"><span>ConversionService</span></a></h3><ul><li>æ˜¯ä¸€ä¸ªé›†ä¸­çš„ç±»å‹è½¬æ¢æœåŠ¡ï¼Œå¯ä»¥ç®¡ç†å¤šä¸ªConverterå’ŒFormatterã€‚</li><li>Controlleræˆ–Serviceéƒ½å¯ä»¥ä½¿ç”¨å®ƒæ¥è¿›è¡Œç±»å‹è½¬æ¢æ“ä½œã€‚</li></ul><p><code>ConversionService</code>æ˜¯Springæ¡†æ¶æä¾›çš„ä¸€ä¸ªæ ¸å¿ƒæ¥å£ï¼Œç”¨äºç±»å‹è½¬æ¢ã€‚è¿™ä¸ªæ¥å£å®šä¹‰äº†ä¸€ä¸ªç»Ÿä¸€çš„ç±»å‹è½¬æ¢ç³»ç»Ÿï¼Œå¯ä»¥åœ¨æ•´ä¸ªSpringåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ï¼ŒåŒ…æ‹¬Spring MVCã€æ•°æ®ç»‘å®šã€SpELè¡¨è¾¾å¼è§£æç­‰åœºæ™¯ã€‚ä¸ç›´æ¥ä½¿ç”¨<code>Converter</code>æ¥å£æˆ–<code>Formatter</code>æ¥å£çš„æ–¹å¼ç›¸æ¯”ï¼Œ<code>ConversionService</code>æä¾›äº†ä¸€ä¸ªé›†ä¸­çš„æ–¹å¼æ¥æ³¨å†Œå’Œç®¡ç†è½¬æ¢å™¨ï¼Œä½¿å¾—ç±»å‹è½¬æ¢é€»è¾‘æ›´åŠ æ¨¡å—åŒ–å’Œå¤ç”¨æ€§æ›´é«˜ã€‚</p><p><strong>ä¸<code>Converter</code>å’Œ<code>Formatter</code>çš„åŒºåˆ«</strong> ï¼š</p><ul><li><p><strong>å¤ç”¨æ€§å’Œå¯ç®¡ç†æ€§</strong>ï¼š<code>ConversionService</code>å…è®¸åœ¨åº”ç”¨ç¨‹åºçš„å¤šä¸ªåœ°æ–¹å¤ç”¨åŒä¸€ä¸ªè½¬æ¢å™¨ï¼Œè€Œä¸å¿…ä¸ºæ¯ä¸ªéœ€è¦è½¬æ¢çš„åœºæ™¯åˆ†åˆ«å®šä¹‰è½¬æ¢å™¨ã€‚è¿™æé«˜äº†è½¬æ¢é€»è¾‘çš„ä¸€è‡´æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p></li><li><p><strong>é›†ä¸­ç®¡ç†</strong>ï¼šé€šè¿‡<code>ConversionService</code>ï¼Œæ‰€æœ‰çš„è½¬æ¢å™¨(<code>Converter</code>å’Œ<code>Formatter</code>)å¯ä»¥åœ¨ä¸€ä¸ªåœ°æ–¹æ³¨å†Œå’Œç®¡ç†ï¼Œè€Œä¸æ˜¯åˆ†æ•£åœ¨å„å¤„ã€‚</p></li><li><p><strong>é€šç”¨æ€§</strong>ï¼š<code>ConversionService</code>ä¸ä»…æ”¯æŒSpring MVCæ¡†æ¶ä¸­çš„æ•°æ®ç»‘å®šå’Œç±»å‹è½¬æ¢ï¼Œè¿˜å¯ä»¥ç”¨äºä»»ä½•éœ€è¦ç±»å‹è½¬æ¢çš„åœºæ™¯ï¼Œå¦‚é…ç½®å±æ€§è½¬æ¢ã€SpELè¡¨è¾¾å¼çš„è¯„ä¼°ç­‰ã€‚</p></li></ul><p><strong>å¦‚ä½•ä½¿ç”¨<code>ConversionService</code></strong> ï¼š</p><ul><li><p><strong>å®šä¹‰Converteræˆ–Formatter</strong>ï¼š<br> é¦–å…ˆï¼Œå®šä¹‰ä½ çš„è½¬æ¢å™¨ï¼Œå¦‚ä¸‹å®šä¹‰ä¸€ä¸ªå¯ä»¥è½¬æ¢å¤šç§æ—¥æœŸæ ¼å¼çš„é€‚é…å™¨</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>convert<span class="token punctuation">.</span>converter<span class="token punctuation">.</span></span><span class="token class-name">Converter</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span><span class="token class-name">ParseException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span><span class="token class-name">SimpleDateFormat</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MultiDateFormatConverter</span> <span class="token keyword">implements</span> <span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Date</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> formats <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token comment">// Define all the date formats you need to support</span>
        formats<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy-MM-dd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        formats<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;dd/MM/yyyy&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        formats<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;MM-dd-yyyy&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Add more formats as necessary</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Date</span> <span class="token function">convert</span><span class="token punctuation">(</span><span class="token class-name">String</span> source<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>source <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> source<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> format <span class="token operator">:</span> formats<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">SimpleDateFormat</span> dateFormat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span>format<span class="token punctuation">)</span><span class="token punctuation">;</span>
            dateFormat<span class="token punctuation">.</span><span class="token function">setLenient</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Set lenient to false to strictly parse dates</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token comment">// Try to parse the source string</span>
                <span class="token keyword">return</span> dateFormat<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ParseException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// If parsing fails, continue to the next format</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;Invalid date format. Please use one of the supported formats: &quot;</span> <span class="token operator">+</span> formats<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>åˆ›å»ºConversionServiceå¹¶æ³¨å†Œè½¬æ¢å™¨</strong>ï¼š<br> æ¥ä¸‹æ¥ï¼Œåˆ›å»ºä¸€ä¸ª<code>ConversionService</code>çš„å®ä¾‹ï¼Œå¹¶å°†ä½ çš„è½¬æ¢å™¨æ³¨å†Œåˆ°å…¶ä¸­ã€‚Springæä¾›äº†<code>DefaultConversionService</code>ï¼Œå®ƒæ˜¯<code>ConversionService</code>çš„ä¸€ä¸ªé»˜è®¤å®ç°ï¼Œæ–¹ä¾¿ä½¿ç”¨ã€‚</p></li><li><p><strong>åœ¨Springé…ç½®ä¸­æ³¨å†ŒConversionService</strong>ï¼š<br> æœ€åï¼Œä½ å¯ä»¥é€šè¿‡ç¼–ç¨‹æ–¹å¼æˆ–è€…é…ç½®æ–¹å¼ï¼Œå°†ä½ çš„<code>ConversionService</code>å®ä¾‹æ³¨å†Œåˆ°Springåº”ç”¨ä¸Šä¸‹æ–‡ä¸­ã€‚</p></li></ul><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>convert<span class="token punctuation">.</span></span><span class="token class-name">ConversionService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>convert<span class="token punctuation">.</span>support<span class="token punctuation">.</span></span><span class="token class-name">DefaultConversionService</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">ConversionService</span> <span class="token function">conversionService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">DefaultConversionService</span> conversionService <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultConversionService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        conversionService<span class="token punctuation">.</span><span class="token function">addConverter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MultiDateFormatConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> conversionService<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸€æ—¦æ³¨å†Œäº†<code>ConversionService</code>ï¼ŒSpringå°±å¯ä»¥è‡ªåŠ¨ä½¿ç”¨å®ƒè¿›è¡Œç±»å‹è½¬æ¢ã€‚ä¾‹å¦‚ï¼Œåœ¨Spring MVCä¸­ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ª<code>@RequestParam</code>æˆ–è€…<code>@ModelAttribute</code>æ ‡æ³¨çš„æ—¥æœŸå‚æ•°ï¼ŒSpringä¼šè‡ªåŠ¨ä½¿ç”¨æ³¨å†Œåˆ°<code>ConversionService</code>ä¸­çš„è½¬æ¢å™¨å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ—¥æœŸç±»å‹ã€‚</p><div class="hint-container tip"><p class="hint-container-title">æ³¨æ„æ‰‹åŠ¨è°ƒç”¨å’Œè‡ªåŠ¨è°ƒç”¨è½¬æ¢å™¨çš„æƒ…å½¢</p><p>åœ¨Spring MVCä¸­ï¼Œç¡®å®ï¼Œå¦‚æœæ‚¨å·²ç»é€šè¿‡<code>@Configuration</code>ç±»å°†è‡ªå®šä¹‰çš„è½¬æ¢å™¨æ³¨å†Œåˆ°äº†<code>ConversionService</code>å¹¶ä¸”è¿™ä¸ª<code>ConversionService</code>æ˜¯Springä¸Šä¸‹æ–‡ç®¡ç†çš„ä¸€éƒ¨åˆ†ï¼Œé‚£ä¹ˆå¯¹äºä½¿ç”¨äº†<code>@RequestParam</code>æˆ–<code>@ModelAttribute</code>æ³¨è§£çš„æ–¹æ³•å‚æ•°ï¼ŒSpringä¼šè‡ªåŠ¨ä½¿ç”¨è¿™äº›æ³¨å†Œåˆ°<code>ConversionService</code>ä¸­çš„è½¬æ¢å™¨æ¥è¿›è¡Œç±»å‹è½¬æ¢ã€‚è¿™æ„å‘³ç€ï¼Œå¯¹äºå¤§å¤šæ•°æ ‡å‡†çš„ç”¨ä¾‹ï¼Œæ‚¨ä¸éœ€è¦æ‰‹åŠ¨è°ƒç”¨<code>ConversionService</code>çš„<code>convert</code>æ–¹æ³•è¿›è¡Œè½¬æ¢ã€‚</p><p>ä»¥ä¸‹æ˜¯è¿™ç§è‡ªåŠ¨è½¬æ¢çš„ä¾‹å­ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/event&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">handleRequest</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;date&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Date</span> date<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// do something with date</span>
    <span class="token keyword">return</span> <span class="token string">&quot;event&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ç‰‡æ®µä¸­ï¼Œå½“ä¸€ä¸ªè¯·æ±‚åŒ…å«ç±»ä¼¼<code>?date=2023-04-17</code>è¿™æ ·çš„æ—¥æœŸå‚æ•°æ—¶ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²åˆ°æ—¥æœŸ(<code>Date</code>)çš„è½¬æ¢å™¨æ³¨å†Œåˆ°äº†<code>ConversionService</code>ï¼ŒSpring MVCä¼šè‡ªåŠ¨ä½¿ç”¨è¿™ä¸ªè½¬æ¢å™¨å°†å­—ç¬¦ä¸²å‚æ•°è½¬æ¢ä¸º<code>Date</code>å¯¹è±¡ã€‚</p><p>ç„¶è€Œï¼Œæœ‰äº›æƒ…å†µä¸‹æ‚¨å¯èƒ½è¿˜æ˜¯éœ€è¦æ‰‹åŠ¨ä½¿ç”¨<code>ConversionService</code>è¿›è¡Œè½¬æ¢ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè½¬æ¢é€»è¾‘åœ¨æœåŠ¡å±‚æˆ–è€…ä½ éœ€è¦åœ¨ä¸€ä¸ªä¸æ¶‰åŠWebè¯·æ±‚å¤„ç†çš„ç»„ä»¶ä¸­è¿›è¡Œç±»å‹è½¬æ¢æ—¶ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥é€šè¿‡ä¾èµ–æ³¨å…¥è·å¾—<code>ConversionService</code>å®ä¾‹ï¼Œå¹¶æ‰‹åŠ¨è°ƒç”¨å…¶<code>convert</code>æ–¹æ³•æ¥è¿›è¡Œéœ€æ±‚çš„è½¬æ¢ã€‚è¿™ç§æ–¹å¼æä¾›äº†æ›´å¤§çš„çµæ´»æ€§ï¼Œå…è®¸åœ¨åº”ç”¨ç¨‹åºçš„ä»»ä½•åœ°æ–¹å¤ç”¨ç›¸åŒçš„è½¬æ¢é€»è¾‘ã€‚</p><p>æ‰‹åŠ¨è°ƒç”¨<code>ConversionService</code>çš„ä¾‹å­å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EventService</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">ConversionService</span> conversionService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token class-name">EventService</span><span class="token punctuation">(</span><span class="token class-name">ConversionService</span> conversionService<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>conversionService <span class="token operator">=</span> conversionService<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">processEvent</span><span class="token punctuation">(</span><span class="token class-name">String</span> dateStr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Date</span> date <span class="token operator">=</span> conversionService<span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span>dateStr<span class="token punctuation">,</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ä½¿ç”¨è½¬æ¢åçš„æ—¥æœŸè¿›è¡Œå¤„ç†</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å› æ­¤ï¼Œæ˜¯å¦æ‰‹åŠ¨è°ƒç”¨<code>ConversionService</code>å–å†³äºæ‚¨çš„å…·ä½“éœ€æ±‚å’Œä¸Šä¸‹æ–‡ã€‚åœ¨Webå±‚å¤„ç†ç”±<code>@RequestParam</code>æˆ–<code>@ModelAttribute</code>æ³¨è§£çš„å‚æ•°æ—¶ï¼Œé€šå¸¸å¯ä»¥ä¾èµ–Springè‡ªåŠ¨è¿›è¡Œè½¬æ¢ï¼›è€Œåœ¨æ›´å¤æ‚æˆ–è‡ªå®šä¹‰çš„é€»è¾‘ä¸­ï¼Œæ‰‹åŠ¨è°ƒç”¨å¯èƒ½æä¾›æ›´é«˜çš„çµæ´»æ€§å’Œæ§åˆ¶ã€‚</p></div><div class="hint-container caution"><p class="hint-container-title">åœ¨Springæ¡†æ¶ä¸­æ³¨å†Œè‡ªå®šä¹‰è½¬æ¢å™¨çš„ä¸¤ç§æ–¹å¼</p><ol><li><p>ä½¿ç”¨<code>WebMvcConfigurer</code>æ¥å£ï¼š<br> è¿™ç§æ–¹å¼é€šå¸¸ç”¨äºSpring MVCé¡¹ç›®ä¸­ã€‚é€šè¿‡å®ç°<code>WebMvcConfigurer</code>æ¥å£å¹¶é‡å†™<code>addFormatters</code>æ–¹æ³•ï¼Œå¯ä»¥å°†è‡ªå®šä¹‰è½¬æ¢å™¨ç›´æ¥æ·»åŠ åˆ°FormatterRegistryä¸­ã€‚è¿™ç§æ–¹å¼ä¸éœ€è¦æ˜¾å¼å®šä¹‰<code>ConversionService</code>çš„<code>Bean</code>ï¼Œå› ä¸ºSpring MVCå°†è‡ªåŠ¨ä½¿ç”¨å®ƒæ¥è¿›è¡Œæ•°æ®ç»‘å®šå’Œç±»å‹è½¬æ¢ï¼Œå°¤å…¶æ˜¯å¯¹äºHTTPè¯·æ±‚å’Œå“åº”ã€‚</p><p>è¿™ç§æ–¹æ³•ç›´æ¥å’ŒSpring MVCçš„Webå±‚é›†æˆï¼Œä¾¿äºç›´æ¥åœ¨æ§åˆ¶å™¨ä¸­å¤„ç†æ¥è‡ªHTTPè¯·æ±‚çš„å‚æ•°è½¬æ¢ã€‚</p></li><li><p>å®šä¹‰<code>ConversionService</code>çš„<code>Bean</code>ï¼š<br> å¦ä¸€ç§æ–¹å¼æ˜¯åœ¨é…ç½®ç±»ä¸­åˆ›å»ºä¸€ä¸ª<code>ConversionService</code>çš„<code>Bean</code>ã€‚<code>ConversionService</code>æ˜¯Springæ¡†æ¶ä¸­ä¸€ä¸ªç‹¬ç«‹çš„ç±»å‹è½¬æ¢ä½“ç³»ï¼Œå®ƒå¯ä»¥åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­çš„ä»»æ„ä½ç½®ä½¿ç”¨ï¼Œä¸ä»…é™äºå¤„ç†Webè¯·æ±‚ã€‚</p><p>è¿™ç§æ–¹å¼æä¾›äº†æ›´å¤šçš„çµæ´»æ€§ï¼Œå› ä¸ºå®ƒå…è®¸å°†<code>ConversionService</code>æ³¨å…¥åˆ°ä»»ä½•éœ€è¦è¿›è¡Œç±»å‹è½¬æ¢çš„ç»„ä»¶ä¸­ã€‚å¦‚æœä½ çš„åº”ç”¨ä¸ä»…ä»…æ˜¯Webåº”ç”¨ï¼Œæˆ–è€…ä½ æƒ³è¦åœ¨éWebå±‚ï¼ˆå¦‚æœåŠ¡å±‚æˆ–æ•°æ®è®¿é—®å±‚ï¼‰ä½¿ç”¨è‡ªå®šä¹‰è½¬æ¢å™¨ï¼Œè¿™ç§æ–¹å¼å¯èƒ½æ›´ç¬¦åˆéœ€æ±‚ã€‚</p></li></ol><p>ç®€å•æ¥è¯´ï¼Œç¬¬ä¸€ç§æ–¹æ³•æ›´ä¸“æ³¨äºWebå±‚é¢çš„è½¬æ¢ï¼ˆå¦‚HTTPè¯·æ±‚åˆ°æ§åˆ¶å™¨æ–¹æ³•çš„å‚æ•°è½¬æ¢ï¼‰ï¼Œè€Œç¬¬äºŒç§æ›´é€šç”¨ï¼Œå¯ä»¥ç”¨äºæ•´ä¸ªåº”ç”¨ç¨‹åºèŒƒå›´å†…çš„ç±»å‹è½¬æ¢ã€‚æ ¹æ®åº”ç”¨ç¨‹åºçš„ç»“æ„å’Œéœ€æ±‚ï¼Œå¼€å‘è€…å¯ä»¥é€‰æ‹©æœ€åˆé€‚çš„æ³¨å†Œæ–¹å¼ã€‚</p></div><h2 id="è¯·æ±‚å‚æ•°æ ¡éªŒä¸ç»“æœå¤„ç†" tabindex="-1"><a class="header-anchor" href="#è¯·æ±‚å‚æ•°æ ¡éªŒä¸ç»“æœå¤„ç†"><span>è¯·æ±‚å‚æ•°æ ¡éªŒä¸ç»“æœå¤„ç†</span></a></h2><h3 id="ä½¿ç”¨validation-api" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨validation-api"><span>ä½¿ç”¨Validation API</span></a></h3><p>Bean Validation APIæ˜¯ä¸€å¥—Javaè§„èŒƒï¼Œå…è®¸é€šè¿‡æ³¨è§£æ¥å£°æ˜å¦‚ä½•å¯¹Java Beanè¿›è¡ŒéªŒè¯ã€‚è¿™ä¸ªAPIçš„è§„èŒƒæ ‡è¯†æ˜¯JSR 303å’ŒJSR 349ï¼Œç°è¡Œç‰ˆæœ¬ä¸ºHibernate Validatorï¼Œå®ƒæä¾›äº†Bean Validationçš„é»˜è®¤å®ç°ã€‚ä½¿ç”¨Bean Validationï¼Œä½ å¯ä»¥åœ¨å®ä½“ç±»ä¸­ç›´æ¥ä½¿ç”¨æ³¨è§£æ¥å£°æ˜éªŒè¯è§„åˆ™ï¼Œç®€åŒ–äº†ä»£ç å¹¶æé«˜äº†å¯è¯»æ€§ã€‚è¿™äº›éªŒè¯è§„åˆ™ä¼šè‡ªåŠ¨åº”ç”¨åˆ°Java Beançš„å±æ€§ä¸Šï¼Œæ˜“äºç»´æŠ¤å’Œé‡ç”¨ã€‚</p><p>å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¾èµ–æ¥å¼•å…¥Hibernate Validatorï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.hibernate<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>hibernate-validator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>6.1.7.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>javax.validation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>validation-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.0.1.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯·æ³¨æ„ï¼Œç‰ˆæœ¬å·å¯èƒ½ä¼šéšç€æ—¶é—´è€Œå˜åŒ–ã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒSpring Bootçš„starterä¾èµ–ï¼ˆspring-boot-starter-validationï¼‰å·²ç»è‡ªåŠ¨åŒ…å«äº†Hibernate Validatorå’Œç›¸å…³çš„Bean Validation APIï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨Spring Bootæ—¶ï¼Œé€šå¸¸åªéœ€æ·»åŠ è¯¥starterä¾èµ–å³å¯</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-validation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">ä¸€äº›å¸¸ç”¨çš„Bean Validationæ³¨è§£</p><ul><li><code>@NotNull</code>ï¼šç¡®ä¿Beançš„å±æ€§å€¼ä¸ä¸ºnullã€‚</li><li><code>@Min(value)</code>å’Œ<code>@Max(value)</code>ï¼šç¡®ä¿Beançš„å±æ€§å€¼åœ¨ç»™å®šçš„èŒƒå›´å†…ã€‚</li><li><code>@Size(min=, max=)</code>ï¼šç¡®ä¿Beançš„å±æ€§å€¼ï¼ˆå­—ç¬¦ä¸²ã€é›†åˆã€æ•°ç»„ç­‰ï¼‰çš„å¤§å°åœ¨ç»™å®šçš„èŒƒå›´å†…ã€‚</li><li><code>@Email</code>ï¼šç¡®ä¿Beançš„å±æ€§å€¼ä¸ºç”µå­é‚®ä»¶æ ¼å¼ã€‚</li><li><code>@NotBlank</code>ï¼šç¡®ä¿Beançš„å­—ç¬¦ä¸²å±æ€§å€¼éç©ºä¸”ä¸ä»…åŒ…å«ç©ºç™½å­—ç¬¦ã€‚</li></ul></div><h4 id="ä½¿ç”¨validation-apiè¿›è¡ŒéªŒè¯" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨validation-apiè¿›è¡ŒéªŒè¯"><span>ä½¿ç”¨Validation APIè¿›è¡ŒéªŒè¯</span></a></h4><p>è¦ä½¿ç”¨Validation APIï¼Œé¦–å…ˆè¦åœ¨ä½ çš„Java Beanå±æ€§ä¸Šæ·»åŠ ç›¸åº”çš„éªŒè¯æ³¨è§£ã€‚ç„¶åï¼Œä½ å¯ä»¥åœ¨æ¥å—ç”¨æˆ·è¾“å…¥çš„åœ°æ–¹ï¼ˆå¦‚Spring MVCçš„æ§åˆ¶å™¨ä¸­ï¼‰ä½¿ç”¨<code>@Valid</code>æˆ–<code>@Validated</code>æ³¨è§£æ¥è§¦å‘éªŒè¯ã€‚</p><p>ä»£ç ç¤ºä¾‹: å‡è®¾ä½ æœ‰ä¸€ä¸ªç”¨æˆ·æ³¨å†Œçš„åœºæ™¯ï¼Œéœ€è¦éªŒè¯ç”¨æˆ·è¾“å…¥çš„æ•°æ®ï¼š</p><p><strong>å®ä½“ç±»ï¼ˆUser.javaï¼‰</strong>:</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span>constraints<span class="token punctuation">.</span></span><span class="token class-name">Email</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span>constraints<span class="token punctuation">.</span></span><span class="token class-name">NotBlank</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@NotBlank</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;ç”¨æˆ·åä¸èƒ½ä¸ºç©º&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Email</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;é‚®ç®±æ ¼å¼ä¸æ­£ç¡®&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span>

    <span class="token comment">// æ ‡å‡†çš„getterå’Œsetter</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ§åˆ¶å™¨ï¼ˆUserController.javaï¼‰</strong>:</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Controller</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>validation<span class="token punctuation">.</span></span><span class="token class-name">BindingResult</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PostMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Controller</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/user&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/register&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">showRegistrationForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;register&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/register&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">registerUser</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Valid</span> <span class="token class-name">User</span> user<span class="token punctuation">,</span> <span class="token class-name">BindingResult</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">hasErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token string">&quot;register&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// ä¿å­˜ç”¨æˆ·æˆ–è¿›è¡Œå…¶ä»–å¤„ç†</span>
        <span class="token keyword">return</span> <span class="token string">&quot;redirect:/user/success&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š</p><ol><li>åœ¨<code>User</code>ç±»ä¸­ï¼Œé€šè¿‡æ·»åŠ <code>@NotBlank</code>å’Œ<code>@Email</code>æ³¨è§£ï¼Œå£°æ˜äº†å¯¹ç”¨æˆ·åå’Œé‚®ç®±çš„éªŒè¯è¦æ±‚ã€‚</li><li>åœ¨<code>UserController</code>ä¸­ï¼Œé€šè¿‡åœ¨<code>registerUser</code>æ–¹æ³•çš„<code>User</code>å‚æ•°å‰æ·»åŠ <code>@Valid</code>æ³¨è§£ï¼Œè§¦å‘äº†<code>User</code>å®ä¾‹çš„éªŒè¯ã€‚å¦‚æœå­˜åœ¨éªŒè¯é”™è¯¯ï¼Œ<code>BindingResult</code>å¯¹è±¡ä¼šè¢«å¡«å……é”™è¯¯ä¿¡æ¯ã€‚</li><li>é€šè¿‡æ£€æŸ¥<code>BindingResult</code>å¯¹è±¡æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨éªŒè¯é”™è¯¯ï¼Œå¹¶æ ¹æ®éªŒè¯ç»“æœè¿”å›ä¸åŒçš„è§†å›¾ã€‚</li></ol><p>ä½¿ç”¨Bean Validation APIè¿›è¡Œæ•°æ®éªŒè¯å¯ä»¥å¤§å¹…ç®€åŒ–éªŒè¯é€»è¾‘ï¼Œä½¿å…¶æ›´åŠ æ¨¡å—åŒ–å’Œæ˜“äºç»´æŠ¤ã€‚é€šè¿‡å£°æ˜å¼çš„æ³¨è§£ï¼Œä½ å¯ä»¥è½»æ¾å®šä¹‰å­—æ®µçš„éªŒè¯è§„åˆ™ï¼Œå¹¶åœ¨æ•´ä¸ªåº”ç”¨ä¸­é‡ç”¨è¿™äº›è§„åˆ™ã€‚</p><h3 id="å®ç°validatoræ¥å£" tabindex="-1"><a class="header-anchor" href="#å®ç°validatoræ¥å£"><span>å®ç°Validatoræ¥å£</span></a></h3><p>Springçš„<code>Validator</code>æ¥å£å…è®¸ä½ åˆ›å»ºè‡ªå®šä¹‰çš„éªŒè¯é€»è¾‘ã€‚ä¸‹é¢æ˜¯ä½¿ç”¨Springçš„<code>Validator</code>æ¥å£è¿›è¡ŒéªŒè¯çš„ä¸€ä¸ªä¾‹å­ï¼š</p><p>å‡è®¾æœ‰ä¸€ä¸ªç”¨æˆ·å®ä½“<code>User</code>éœ€è¦éªŒè¯ï¼Œé¦–å…ˆè¦å®šä¹‰<code>User</code>ç±»ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span>

    <span class="token comment">// getters and setters</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶ååˆ›å»ºä¸€ä¸ªå®ç°äº†<code>Validator</code>æ¥å£çš„è‡ªå®šä¹‰éªŒè¯å™¨ç±»<code>UserValidator</code>ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>validation<span class="token punctuation">.</span></span><span class="token class-name">Errors</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>validation<span class="token punctuation">.</span></span><span class="token class-name">ValidationUtils</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>validation<span class="token punctuation">.</span></span><span class="token class-name">Validator</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserValidator</span> <span class="token keyword">implements</span> <span class="token class-name">Validator</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">supports</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> clazz<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>clazz<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">validate</span><span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">,</span> <span class="token class-name">Errors</span> errors<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ValidationUtils</span><span class="token punctuation">.</span><span class="token function">rejectIfEmptyOrWhitespace</span><span class="token punctuation">(</span>errors<span class="token punctuation">,</span> <span class="token string">&quot;username&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;field.required&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Username is required.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ValidationUtils</span><span class="token punctuation">.</span><span class="token function">rejectIfEmptyOrWhitespace</span><span class="token punctuation">(</span>errors<span class="token punctuation">,</span> <span class="token string">&quot;email&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;field.required&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Email is required.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">)</span> obj<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>user<span class="token punctuation">.</span><span class="token function">getEmail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">&quot;@&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            errors<span class="token punctuation">.</span><span class="token function">rejectValue</span><span class="token punctuation">(</span><span class="token string">&quot;email&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;email.invalid&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Email is not valid.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ª<code>UserValidator</code>ç±»ä¸­ï¼Œ<code>validate</code>æ–¹æ³•å®šä¹‰äº†å…·ä½“çš„éªŒè¯é€»è¾‘ã€‚é¦–å…ˆä½¿ç”¨<code>ValidationUtils.rejectIfEmptyOrWhitespace</code>ç®€å•åœ°æ£€æŸ¥å­—æ®µæ˜¯å¦ä¸ºç©ºæˆ–è€…åªæœ‰ç©ºæ ¼ã€‚ç„¶åï¼Œè¯¦ç»†æ£€æŸ¥ç”µå­é‚®ä»¶æ˜¯å¦åŒ…å«&#39;@&#39;ç¬¦å·ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œåœ¨Springçš„æ§åˆ¶å™¨ä¸­ä½¿ç”¨<code>UserValidator</code>ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Controller</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>validation<span class="token punctuation">.</span></span><span class="token class-name">BindingResult</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ModelAndView</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Controller</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">UserValidator</span> userValidator<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token class-name">UserController</span><span class="token punctuation">(</span><span class="token class-name">UserValidator</span> userValidator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>userValidator <span class="token operator">=</span> userValidator<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/user/register&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ModelAndView</span> <span class="token function">showRegistrationForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ModelAndView</span><span class="token punctuation">(</span><span class="token string">&quot;register&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/user/register&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">registerUser</span><span class="token punctuation">(</span><span class="token annotation punctuation">@ModelAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span> <span class="token class-name">User</span> user<span class="token punctuation">,</span> <span class="token class-name">BindingResult</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        userValidator<span class="token punctuation">.</span><span class="token function">validate</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">hasErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token string">&quot;register&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
        <span class="token comment">// ... å¯¹userè¿›è¡Œæ•°æ®ä¿å­˜ç­‰è¿›ä¸€æ­¥å¤„ç†</span>
        
        <span class="token keyword">return</span> <span class="token string">&quot;redirect:/user/success&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨<code>UserController</code>ä¸­ï¼Œé¦–å…ˆæ³¨å…¥äº†è‡ªå®šä¹‰çš„<code>UserValidator</code>ã€‚åœ¨å¤„ç†ç”¨æˆ·æ³¨å†Œçš„POSTè¯·æ±‚çš„<code>registerUser</code>æ–¹æ³•ä¸­ï¼Œæ‰‹åŠ¨è°ƒç”¨<code>userValidator.validate(user, result)</code>è§¦å‘éªŒè¯ã€‚å¦‚æœ<code>result</code>ä¸­å‘ç°é”™è¯¯ï¼Œå®ƒä»¬ä¼šè¢«åé¦ˆå›æ³¨å†Œè¡¨å•è§†å›¾ã€‚</p><p>åœ¨æ³¨å†Œè¡¨å•è§†å›¾ä¸­ï¼Œä½ éœ€è¦å±•ç¤ºé”™è¯¯ä¿¡æ¯ã€‚å¦‚æœä½ ä½¿ç”¨çš„æ˜¯Thymeleafæ¨¡æ¿å¼•æ“ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><div class="language-html line-numbers-mode" data-ext="html" data-title="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">th:</span>action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@{/user/register}<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">th:</span>object</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${user}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>post<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Username:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">th:</span>field</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>*{username}<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name"><span class="token namespace">th:</span>if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${#fields.hasErrors(&#39;username&#39;)}<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">th:</span>errors</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>*{username}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Username Error<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>email<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Email:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>email<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">th:</span>field</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>*{email}<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name"><span class="token namespace">th:</span>if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${#fields.hasErrors(&#39;email&#39;)}<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">th:</span>errors</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>*{email}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Email Error<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Register<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œä½¿ç”¨äº†<code>th:errors</code>æ¥æ˜¾ç¤ºå¯¹åº”å­—æ®µçš„éªŒè¯é”™è¯¯æ¶ˆæ¯ã€‚å¦‚æœæœ‰é”™è¯¯ï¼Œæ¶ˆæ¯ä¼šæ˜¾ç¤ºåœ¨è¾“å…¥å­—æ®µæ—è¾¹ã€‚</p><p>é€šè¿‡ä½¿ç”¨Springçš„<code>Validator</code>æ¥å£ï¼Œä½ å¯ä»¥åˆ›å»ºéå¸¸å…·ä½“å’Œå¤æ‚çš„éªŒè¯é€»è¾‘ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ä¸åŒçš„åœ°æ–¹é‡ç”¨è¿™äº›é€»è¾‘ã€‚è¿™æ¯”åœ¨å®ä½“ç±»ä¸­ä½¿ç”¨æ³¨è§£å£°æ˜éªŒè¯è§„åˆ™æ›´çµæ´»ï¼Œä½†åŒæ ·ä¹Ÿæ›´ç¹çã€‚ä½ é€šå¸¸ä¼šåœ¨éœ€è¦éå¸¸ç‰¹å®šæˆ–å¤æ‚çš„éªŒè¯é€»è¾‘æ—¶é€‰æ‹©è¿™ç§æ–¹å¼ã€‚</p><h3 id="åˆ†ç»„éªŒè¯-group-validation" tabindex="-1"><a class="header-anchor" href="#åˆ†ç»„éªŒè¯-group-validation"><span>åˆ†ç»„éªŒè¯(Group validation)</span></a></h3><p>åœ¨å¤æ‚çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦æ ¹æ®ä¸åŒçš„æ“ä½œå¯¹åŒä¸€ä¸ªå¯¹è±¡è¿›è¡Œä¸åŒçš„éªŒè¯ã€‚<code>@Validated</code>æ³¨è§£å’Œåˆ†ç»„éªŒè¯ï¼ˆGroup validationï¼‰åŠŸèƒ½å…è®¸æˆ‘ä»¬é’ˆå¯¹ä¸åŒåœºæ™¯æ‰§è¡Œä¸åŒçš„éªŒè¯è§„åˆ™ã€‚</p><p>é¦–å…ˆï¼Œåˆ›å»ºéªŒè¯åˆ†ç»„æ¥å£ï¼Œç”¨äºæ ‡è¯†ä¸åŒçš„éªŒè¯åœºæ™¯ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ValidationGroups</span> <span class="token punctuation">{</span>
    <span class="token keyword">interface</span> <span class="token class-name">Create</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">interface</span> <span class="token class-name">Update</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¥ä¸‹æ¥ï¼Œåœ¨å®ä½“ç±»ä¸­ä½¿ç”¨åˆ†ç»„æ¥å£ä¸ºä¸åŒçš„éªŒè¯è§„åˆ™è¿›è¡Œåˆ†ç»„ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>

    <span class="token comment">// åœ¨åˆ›å»ºï¼ˆCreateï¼‰æ“ä½œæ—¶éªŒè¯</span>
    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>groups <span class="token operator">=</span> <span class="token class-name">ValidationGroups<span class="token punctuation">.</span>Create</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

    <span class="token comment">// åœ¨åˆ›å»ºï¼ˆCreateï¼‰å’Œæ›´æ–°ï¼ˆUpdateï¼‰æ“ä½œæ—¶éªŒè¯</span>
    <span class="token annotation punctuation">@NotBlank</span><span class="token punctuation">(</span>groups <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">ValidationGroups<span class="token punctuation">.</span>Create</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">ValidationGroups<span class="token punctuation">.</span>Update</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span>
    
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åï¼Œåœ¨æ§åˆ¶å™¨ä¸­é€šè¿‡åœ¨<code>@Validated</code>æ³¨è§£ä¸­æŒ‡å®šåˆ†ç»„æ¥è§¦å‘ç›¸åº”çš„éªŒè¯è§„åˆ™ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/user&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/create&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">createUser</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Validated</span><span class="token punctuation">(</span><span class="token class-name">ValidationGroups<span class="token punctuation">.</span>Create</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å¤„ç†åˆ›å»ºç”¨æˆ·é€»è¾‘</span>
        <span class="token keyword">return</span> <span class="token string">&quot;User created&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@PutMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/update&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">updateUser</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Validated</span><span class="token punctuation">(</span><span class="token class-name">ValidationGroups<span class="token punctuation">.</span>Update</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å¤„ç†æ›´æ–°ç”¨æˆ·é€»è¾‘</span>
        <span class="token keyword">return</span> <span class="token string">&quot;User updated&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡ä¸Šè¿°ä»£ç ï¼Œå¯ä»¥åœ¨åˆ›å»ºæˆ–æ›´æ–°<code>User</code>å®ä¾‹æ—¶æ ¹æ®æƒ…å¢ƒé€‰æ‹©é€‚å½“çš„éªŒè¯è§„åˆ™ã€‚</p><div class="hint-container tip"><p class="hint-container-title">åˆ†ç»„éªŒè¯çš„åº”ç”¨åœºæ™¯</p><ul><li>åˆ›å»ºå’Œæ›´æ–°æ“ä½œï¼šåœ¨RESTful APIè®¾è®¡ä¸­ï¼Œåˆ›å»ºï¼ˆPOSTï¼‰å’Œæ›´æ–°ï¼ˆPUTï¼‰é€šå¸¸ä½¿ç”¨ç›¸åŒçš„å¯¹è±¡æ¨¡å‹ã€‚ä½†åœ¨åˆ›å»ºæ—¶å¯èƒ½ä¸éœ€è¦IDå­—æ®µï¼ˆç”±ç³»ç»Ÿç”Ÿæˆï¼‰ï¼Œè€Œåœ¨æ›´æ–°æ—¶åˆ™æ˜¯å¿…é¡»çš„ã€‚é€šè¿‡åˆ†ç»„éªŒè¯ï¼Œä½ å¯ä»¥ä¸ºåˆ›å»ºå’Œæ›´æ–°å®šä¹‰ä¸åŒçš„éªŒè¯è§„åˆ™ã€‚</li><li>åˆ†æ­¥éª¤çš„è¡¨å•æäº¤ï¼šåœ¨å¤æ‚çš„è¡¨å•æµç¨‹ä¸­ï¼Œç”¨æˆ·å¯èƒ½éœ€è¦åˆ†å¤šä¸ªæ­¥éª¤æäº¤æ•°æ®ã€‚æ¯ä¸ªæ­¥éª¤å¯èƒ½åªéœ€è¦éªŒè¯è¡¨å•çš„ä¸€éƒ¨åˆ†ã€‚å¯ä»¥ä¸ºæ¯ä¸ªæ­¥éª¤åˆ›å»ºä¸åŒçš„éªŒè¯ç»„ï¼Œç¡®ä¿åªéªŒè¯å½“å‰æ­¥éª¤çš„æ•°æ®ã€‚</li><li>ç”¨æˆ·è§’è‰²å’Œæƒé™ï¼šæ ¹æ®ç”¨æˆ·çš„è§’è‰²æˆ–æƒé™æ¥å†³å®šæ˜¯å¦æ‰§è¡Œç‰¹å®šå­—æ®µçš„éªŒè¯ã€‚ä¾‹å¦‚ï¼Œæ™®é€šç”¨æˆ·å¯èƒ½ä¸éœ€è¦éªŒè¯æŸäº›åªæœ‰ç®¡ç†å‘˜æ‰éœ€è¦å¡«å†™çš„å­—æ®µã€‚</li><li>æ¡ä»¶æ€§éªŒè¯ï¼šåœ¨æŸäº›æ¡ä»¶ä¸‹ï¼ŒæŸäº›å­—æ®µå¯èƒ½æ˜¯å¿…å¡«çš„ï¼Œè€Œåœ¨å…¶ä»–æ¡ä»¶ä¸‹åˆ™ä¸æ˜¯ã€‚å¯ä»¥é€šè¿‡åˆ†ç»„æ£€éªŒæ¥æ ¹æ®æ¡ä»¶å†³å®šæ˜¯å¦éœ€è¦éªŒè¯è¿™äº›å­—æ®µã€‚</li><li>è§†å›¾å±‚éªŒè¯ï¼šåœ¨å¤šè§†å›¾åº”ç”¨ä¸­ï¼Œä¸åŒçš„è§†å›¾å¯èƒ½éœ€è¦éªŒè¯ä¸åŒçš„å­—æ®µé›†ã€‚åˆ†ç»„éªŒè¯å…è®¸ä½ ä¸ºæ¯ä¸ªè§†å›¾å®šä¹‰ä¸€ä¸ªä¸“é—¨çš„éªŒè¯é€»è¾‘ã€‚</li></ul></div><h3 id="è·¨å­—æ®µéªŒè¯-cross-field-validation" tabindex="-1"><a class="header-anchor" href="#è·¨å­—æ®µéªŒè¯-cross-field-validation"><span>è·¨å­—æ®µéªŒè¯(Cross-field validation)</span></a></h3><p>è·¨å­—æ®µéªŒè¯æ¶‰åŠåˆ°äº†åŸºäºå¤šä¸ªå­—æ®µçš„å€¼è¿›è¡Œé€»è¾‘åˆ¤æ–­çš„éœ€æ±‚ï¼Œä¾‹å¦‚ï¼Œç¡®è®¤å¯†ç å­—æ®µæ˜¯å¦ä¸å¯†ç å­—æ®µç›¸åŒ¹é…ã€‚ä¸ºäº†å®ç°è·¨å­—æ®µéªŒè¯ï¼Œä½ é€šå¸¸éœ€è¦è‡ªå®šä¹‰éªŒè¯æ³¨è§£å¹¶åˆ›å»ºç›¸åº”çš„éªŒè¯å™¨ã€‚</p><p>å‡è®¾ä½ è¦éªŒè¯ä¸¤ä¸ªå­—æ®µ<code>password</code>å’Œ<code>confirmPassword</code>æ˜¯å¦ç›¸åŒï¼š</p><ol><li>å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰çš„æ³¨è§£<code>FieldMatch</code>ï¼š</li></ol><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">TYPE</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Constraint</span><span class="token punctuation">(</span>validatedBy <span class="token operator">=</span> <span class="token class-name">FieldMatchValidator</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">FieldMatch</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> <span class="token function">message</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">&quot;The fields must match&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">groups</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Payload</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">payload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> <span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> <span class="token function">second</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">TYPE</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@interface</span> <span class="token class-name">List</span> <span class="token punctuation">{</span>
        <span class="token class-name">FieldMatch</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>åˆ›å»ºè¯¥æ³¨è§£çš„éªŒè¯å™¨<code>FieldMatchValidator</code>ï¼š</li></ol><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FieldMatchValidator</span> <span class="token keyword">implements</span> <span class="token class-name">ConstraintValidator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FieldMatch</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> firstFieldName<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> secondFieldName<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">initialize</span><span class="token punctuation">(</span><span class="token class-name">FieldMatch</span> constraintAnnotation<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        firstFieldName <span class="token operator">=</span> constraintAnnotation<span class="token punctuation">.</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        secondFieldName <span class="token operator">=</span> constraintAnnotation<span class="token punctuation">.</span><span class="token function">second</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isValid</span><span class="token punctuation">(</span><span class="token class-name">Object</span> value<span class="token punctuation">,</span> <span class="token class-name">ConstraintValidatorContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">final</span> <span class="token class-name">Object</span> firstObj <span class="token operator">=</span> <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> firstFieldName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">final</span> <span class="token class-name">Object</span> secondObj <span class="token operator">=</span> <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> secondFieldName<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">return</span> firstObj <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> secondObj <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> firstObj <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> firstObj<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>secondObj<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">Exception</span> ignore<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// ignore</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>åœ¨éœ€è¦è¿›è¡Œè·¨å­—æ®µéªŒè¯çš„ç±»ä¸Šä½¿ç”¨<code>@FieldMatch</code>æ³¨è§£ï¼š</li></ol><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@FieldMatch.List</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@FieldMatch</span><span class="token punctuation">(</span>first <span class="token operator">=</span> <span class="token string">&quot;password&quot;</span><span class="token punctuation">,</span> second <span class="token operator">=</span> <span class="token string">&quot;confirmPassword&quot;</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;The password fields must match&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserRegistrationDto</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¯¹åº”å­—æ®µçš„getterå’Œsetter</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è‡ªå®šä¹‰æ³¨è§£<code>FieldMatch</code>å®ç°äº†å¯†ç å’Œç¡®è®¤å¯†ç ä¸¤ä¸ªå­—æ®µä¹‹é—´çš„åŒ¹é…éªŒè¯ã€‚</p><p>è¿™ç§æ–¹å¼ä½¿å¾—éªŒè¯é€»è¾‘æ›´åŠ çµæ´»å’Œå¼ºå¤§ï¼Œå¯ä»¥åº”å¯¹å„ç§å¤æ‚çš„ä¸šåŠ¡éœ€æ±‚ã€‚</p><div class="hint-container tip"><p class="hint-container-title">è·¨å­—æ®µéªŒè¯çš„åº”ç”¨åœºæ™¯</p><ul><li>å­—æ®µæ¯”è¾ƒï¼šæœ€å¸¸è§çš„è·¨å­—æ®µéªŒè¯æƒ…å†µå°±æ˜¯å¯†ç å’Œç¡®è®¤å¯†ç å¿…é¡»åŒ¹é…ï¼Œéœ€è¦éªŒè¯å…¶ä¸­ä¸¤ä¸ªå­—æ®µæ˜¯å¦ä¸€è‡´ã€‚</li><li>ä¾èµ–å…³ç³»éªŒè¯ï¼šå½“ä¸€ä¸ªå­—æ®µçš„å€¼ä¾èµ–äºå¦ä¸€ä¸ªå­—æ®µçš„å€¼æ—¶ï¼Œæ¯”å¦‚â€œç»“æŸæ—¥æœŸâ€ä¸èƒ½æ—©äºâ€œå¼€å§‹æ—¥æœŸâ€ã€‚</li><li>å¤æ‚è§„åˆ™çš„ä¸šåŠ¡é€»è¾‘éªŒè¯ï¼šä¾‹å¦‚ï¼Œåœ°å€éªŒè¯ä¸­ï¼Œå¦‚æœå›½å®¶æ˜¯â€œç¾å›½â€ï¼Œåˆ™è¦æ±‚â€œå·â€å­—æ®µå¿…é¡»æ˜¯æœ‰æ•ˆçš„ç¾å›½å·åç§°ï¼›å¯¹äºå…¶å®ƒå›½å®¶ï¼Œåˆ™æ— æ­¤è¦æ±‚ã€‚</li><li>å…¨å±€ä¸šåŠ¡è§„åˆ™ï¼šå¯èƒ½æ¶‰åŠåˆ°å¤šä¸ªå­—æ®µï¼Œæ¯”å¦‚ä¸€ç»„å­—æ®µçš„æ€»å’Œä¸å¾—è¶…è¿‡ç‰¹å®šçš„æ•°å€¼ã€‚</li><li>æ¡ä»¶å¼éªŒè¯ï¼šå¦‚æœå­—æ®µAçš„å€¼æ»¡è¶³æŸä¸€æ¡ä»¶ï¼Œåˆ™å­—æ®µBå¿…é¡»éç©ºï¼Œå¦åˆ™å¯ä»¥ä¸ºç©ºã€‚</li></ul></div><h3 id="ä½¿ç”¨aopè¿›è¡Œå‚æ•°æ ¡éªŒ" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨aopè¿›è¡Œå‚æ•°æ ¡éªŒ"><span>ä½¿ç”¨AOPè¿›è¡Œå‚æ•°æ ¡éªŒ</span></a></h3><p>é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰æ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼Œæ—¨åœ¨é€šè¿‡å°†æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼ˆå¦‚æ—¥å¿—ã€äº‹åŠ¡ç®¡ç†ã€å®‰å…¨æ€§å’Œå‚æ•°æ ¡éªŒï¼‰ä»ä¸šåŠ¡é€»è¾‘ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œæé«˜ä»£ç çš„æ¨¡å—åŒ–ã€‚åœ¨Springæ¡†æ¶ä¸­ï¼Œé€šå¸¸å¯ä»¥ä½¿ç”¨AOPæ¥å®ç°å‚æ•°æ ¡éªŒï¼Œä»è€Œä½¿å¾—ä»£ç æ›´åŠ ç®€æ´å’Œæ˜“äºç®¡ç†ã€‚</p><p><strong>AOPè¿›è¡Œå‚æ•°æ ¡éªŒ</strong>çš„ä½¿ç”¨åœºæ™¯åŒ…æ‹¬ä½†ä¸é™äºï¼š</p><ol><li>ç»Ÿä¸€å¤„ç†å…¥å£å‚æ•°æ ¡éªŒï¼Œå‡å°‘åœ¨æ¯ä¸ªæ–¹æ³•ä¸­é‡å¤è¿›è¡Œå‚æ•°æ ¡éªŒçš„ä»£ç ã€‚</li><li>åœ¨ä¸šåŠ¡æ–¹æ³•æ‰§è¡Œä¹‹å‰ï¼Œæ ¡éªŒä¼ å…¥å‚æ•°çš„æœ‰æ•ˆæ€§ï¼Œå¦‚æœå‚æ•°ä¸ç¬¦åˆè¦æ±‚ï¼Œå¯ä»¥ç›´æ¥è¿”å›é”™è¯¯å“åº”ï¼Œé˜»æ­¢æ–¹æ³•æ‰§è¡Œã€‚</li><li>å¯¹äºRESTful APIç­‰åœºåˆï¼Œå¯ä»¥è¿›è¡Œå…¨å±€çš„è¯·æ±‚å‚æ•°æ ¡éªŒï¼Œæå‡APIçš„å¥å£®æ€§ã€‚</li><li>åœ¨è°ƒç”¨é‡è¦ä¸šåŠ¡é€»è¾‘ä¹‹å‰è¿›è¡Œæƒé™æ ¡éªŒæˆ–å‚æ•°æ ¼å¼æ ¡éªŒï¼Œç¡®ä¿æ•°æ®çš„å‡†ç¡®æ€§å’Œå®‰å…¨æ€§ã€‚</li></ol><p>ç¤ºä¾‹ä»£ç ï¼š</p><p>å‡è®¾æœ‰ä¸€ä¸ªç®€å•çš„æœåŠ¡æ–¹æ³•ï¼Œéœ€è¦æ ¡éªŒä¼ å…¥çš„ç”¨æˆ·å¹´é¾„æ˜¯å¦ç¬¦åˆè¦æ±‚ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserService</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addUser</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Adding user: &quot;</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">&quot;, age: &quot;</span> <span class="token operator">+</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æ·»åŠ ç”¨æˆ·çš„é€»è¾‘</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨ï¼Œæˆ‘ä»¬ä½¿ç”¨Spring AOPæ¥å®ç°å¯¹<code>addUser</code>æ–¹æ³•çš„å¹´é¾„å‚æ•°è¿›è¡Œæ ¡éªŒã€‚</p><ol><li><strong>å®šä¹‰ä¸€ä¸ªåˆ‡é¢ç±»ï¼ˆAspect Classï¼‰è¿›è¡Œå‚æ•°æ ¡éªŒ</strong>ï¼š</li></ol><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>aspectj<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span><span class="token class-name">JoinPoint</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>aspectj<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Aspect</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>aspectj<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Before</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>aspectj<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Pointcut</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Component</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Aspect</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ValidationAspect</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Pointcut</span><span class="token punctuation">(</span><span class="token string">&quot;execution(* com.example.service.UserService.addUser(..))&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">validateAgePointcut</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Before</span><span class="token punctuation">(</span><span class="token string">&quot;validateAgePointcut()&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">validateAgeBefore</span><span class="token punctuation">(</span><span class="token class-name">JoinPoint</span> joinPoint<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args <span class="token operator">=</span> joinPoint<span class="token punctuation">.</span><span class="token function">getArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">instanceof</span> <span class="token class-name">Integer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> age <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">)</span> args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>age <span class="token operator">&lt;</span> <span class="token number">18</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;Age must be greater than or equal to 18.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªåˆ‡é¢<code>ValidationAspect</code>ï¼Œå¹¶æŒ‡å®šäº†ä¸€ä¸ªåˆ‡å…¥ç‚¹<code>validateAgePointcut</code>ï¼Œå®ƒåŒ¹é…<code>UserService</code>ä¸­çš„<code>addUser</code>æ–¹æ³•ã€‚ç„¶åï¼Œæˆ‘ä»¬ç”¨<code>@Before</code>æ³¨è§£å®šä¹‰äº†ä¸€ä¸ªåœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œä¹‹å‰è¿è¡Œçš„å»ºè®®ï¼ˆAdviceï¼‰ï¼Œå®ƒä¼šæ‰§è¡Œå‚æ•°æ ¡éªŒé€»è¾‘ã€‚å¦‚æœå¹´é¾„å‚æ•°ä¸ç¬¦åˆè¦æ±‚ï¼ˆå°äº18å²ï¼‰ï¼Œåˆ™æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚</p><ol start="2"><li><strong>ç¡®ä¿ä½ çš„Springé…ç½®æ”¯æŒAOP</strong>ï¼š</li></ol><p>ç¡®ä¿åœ¨Springé…ç½®ä¸­å·²ç»å¯ç”¨äº†AOPçš„è‡ªåŠ¨ä»£ç†ã€‚å¦‚æœä½ ä½¿ç”¨çš„æ˜¯Javaé…ç½®ï¼Œå¯ä»¥é€šè¿‡<code>@EnableAspectJAutoProxy</code>æ³¨è§£æ¥å¯ç”¨ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">EnableAspectJAutoProxy</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableAspectJAutoProxy</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{</span>
    <span class="token comment">// å…¶ä»–Beançš„é…ç½®</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨AOPè¿›è¡Œå‚æ•°æ ¡éªŒèƒ½å¤Ÿä½¿å¾—æ ¡éªŒé€»è¾‘ä¸ä¸šåŠ¡é€»è¾‘åˆ†ç¦»ï¼Œæé«˜ä»£ç çš„é‡ç”¨æ€§å’Œæ¸…æ™°åº¦ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶é€šè¿‡AOPèƒ½å¤Ÿå®ç°å¼ºå¤§çš„æ¨ªåˆ‡é€»è¾‘ï¼Œä½†è¿‡åº¦ä½¿ç”¨å¯èƒ½ä¼šä½¿å¾—ç¨‹åºé€»è¾‘å˜å¾—éš¾ä»¥è·Ÿè¸ªï¼Œå› æ­¤è¯·æ ¹æ®å®é™…éœ€æ±‚è°¨æ…ä½¿ç”¨ã€‚</p><h3 id="å‚æ•°æ ¡éªŒç¤ºä¾‹ä¸ç»“æœå¤„ç†" tabindex="-1"><a class="header-anchor" href="#å‚æ•°æ ¡éªŒç¤ºä¾‹ä¸ç»“æœå¤„ç†"><span>å‚æ•°æ ¡éªŒç¤ºä¾‹ä¸ç»“æœå¤„ç†</span></a></h3><p>è®©æˆ‘ä»¬ä»¥ä¸€ä¸ªå¸¸è§çš„æ³¨å†Œåœºæ™¯ä¸ºä¾‹ï¼Œå…¶ä¸­éœ€è¦è¿›è¡Œè·¨å­—æ®µéªŒè¯ï¼šéªŒè¯ä¸¤æ¬¡è¾“å…¥çš„å¯†ç æ˜¯å¦ä¸€è‡´ï¼Œå¹¶ç¡®ä¿ç”¨æˆ·å¹´é¾„åœ¨åˆæ³•èŒƒå›´å†…ã€‚æˆ‘ä»¬å°†ä½¿ç”¨Spring Bootä½œä¸ºåŸºç¡€ï¼Œåˆ©ç”¨Hibernate Validatorè¿›è¡Œæ ¡éªŒï¼Œå¹¶é€šè¿‡è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†æ¥å®ç°ç»Ÿä¸€å¤„ç†æ ¡éªŒç»“æœã€‚</p><p>é¦–å…ˆï¼Œå®šä¹‰ä¸€ä¸ªç”¨æˆ·æ³¨å†Œçš„è¯·æ±‚å¯¹è±¡ï¼ŒåŒ…å«ç”¨æˆ·åã€å¯†ç ã€ç¡®è®¤å¯†ç å’Œå¹´é¾„å­—æ®µã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span>constraints<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserRegistrationRequest</span> <span class="token punctuation">{</span>
    
    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;ç”¨æˆ·åä¸èƒ½ä¸ºç©º&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;å¯†ç ä¸èƒ½ä¸ºç©º&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;ç¡®è®¤å¯†ç ä¸èƒ½ä¸ºç©º&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> confirmPassword<span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@Min</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;å¹´é¾„å¿…é¡»è‡³å°‘ä¸º18&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Max</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token number">150</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;å¹´é¾„ä¸å¾—è¶…è¿‡150&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>

    <span class="token comment">// çœç•¥æ„é€ å‡½æ•°ã€getterå’Œsetteræ–¹æ³•</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¥ç€ï¼Œåˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰æ³¨è§£ç”¨äºè·¨å­—æ®µéªŒè¯ï¼ˆæ¯”å¦‚ï¼ŒéªŒè¯å¯†ç å’Œç¡®è®¤å¯†ç æ˜¯å¦ä¸€è‡´ï¼‰ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span></span><span class="token class-name">Constraint</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span></span><span class="token class-name">Payload</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Documented</span>
<span class="token annotation punctuation">@Constraint</span><span class="token punctuation">(</span>validatedBy <span class="token operator">=</span> <span class="token class-name">PasswordMatchesValidator</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">TYPE</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">PasswordMatches</span> <span class="token punctuation">{</span>

    <span class="token class-name">String</span> <span class="token function">message</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">&quot;å¯†ç å’Œç¡®è®¤å¯†ç ä¸åŒ¹é…&quot;</span><span class="token punctuation">;</span>

    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">groups</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Payload</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">payload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®šä¹‰<code>PasswordMatchesValidator</code>æ¥å®ç°è¿™ä¸ªæ³¨è§£çš„é€»è¾‘ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span></span><span class="token class-name">ConstraintValidator</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span></span><span class="token class-name">ConstraintValidatorContext</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PasswordMatchesValidator</span> <span class="token keyword">implements</span> <span class="token class-name">ConstraintValidator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PasswordMatches</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">initialize</span><span class="token punctuation">(</span><span class="token class-name">PasswordMatches</span> constraintAnnotation<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isValid</span><span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">,</span> <span class="token class-name">ConstraintValidatorContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">UserRegistrationRequest</span> user <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">UserRegistrationRequest</span><span class="token punctuation">)</span> obj<span class="token punctuation">;</span>
        <span class="token keyword">return</span> user<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getConfirmPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨<code>UserRegistrationRequest</code>ç±»ä¸Šä½¿ç”¨<code>@PasswordMatches</code>æ³¨è§£ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@PasswordMatches</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserRegistrationRequest</span> <span class="token punctuation">{</span>
    <span class="token comment">// å­—æ®µå®šä¹‰</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç³»ç»Ÿå…¨å±€å¼‚å¸¸å¤„ç†å™¨æ¥ç»Ÿä¸€å¤„ç†æ ¡éªŒå¼‚å¸¸ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span></span><span class="token class-name">MethodArgumentNotValidException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">ExceptionHandler</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestControllerAdvice</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestControllerAdvice</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GlobalExceptionHandler</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">MethodArgumentNotValidException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">handleValidationExceptions</span><span class="token punctuation">(</span><span class="token class-name">MethodArgumentNotValidException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> errors <span class="token operator">=</span> ex<span class="token punctuation">.</span><span class="token function">getBindingResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                 <span class="token punctuation">.</span><span class="token function">getAllErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                 <span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                 <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">ObjectError</span><span class="token operator">::</span><span class="token function">getDefaultMessage</span><span class="token punctuation">)</span>
                                 <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>errors<span class="token punctuation">,</span> <span class="token class-name">HttpStatus</span><span class="token punctuation">.</span><span class="token constant">BAD_REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æœ€åï¼Œåœ¨æ§åˆ¶å™¨ä¸­ä½¿ç”¨è¿™ä¸ªè¯·æ±‚å¯¹è±¡ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">ResponseEntity</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>validation<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Validated</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PostMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestBody</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/register&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">registerUser</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Validated</span> <span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">UserRegistrationRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ³¨å†Œç”¨æˆ·çš„ä¸šåŠ¡é€»è¾‘</span>
        <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token string">&quot;ç”¨æˆ·æ³¨å†ŒæˆåŠŸ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬èƒ½å¤Ÿåœ¨ç”¨æˆ·æ³¨å†Œå¯¹è±¡<code>UserRegistrationRequest</code>ä¸­è¿›è¡Œå¤æ‚çš„è·¨å­—æ®µéªŒè¯ï¼ˆç¡®ä¿å¯†ç å’Œç¡®è®¤å¯†ç ä¸€è‡´ï¼‰ï¼Œå¹¶ä¸”é€šè¿‡å…¨å±€å¼‚å¸¸å¤„ç†å™¨<code>GlobalExceptionHandler</code>æ¥ç»Ÿä¸€å¤„ç†ä¸ç¬¦åˆéªŒè¯è§„åˆ™çš„æƒ…å†µï¼Œè¿”å›ç»Ÿä¸€æ ¼å¼çš„é”™è¯¯ä¿¡æ¯ã€‚è¿™æ ·ï¼Œæ— è®ºæ˜¯å•å­—æ®µéªŒè¯è¿˜æ˜¯è·¨å­—æ®µéªŒè¯ï¼Œæ‰€æœ‰æ ¡éªŒå¤±è´¥çš„æƒ…å†µéƒ½å¯ä»¥å¾—åˆ°ç»Ÿä¸€ä¸”å‹å¥½çš„å¤„ç†ã€‚</p><div class="hint-container caution"><p class="hint-container-title">MethodArgumentNotValidExceptionç»Ÿä¸€æ ¡éªŒå¼‚å¸¸å¤„ç†</p><p>åœ¨Springæ¡†æ¶ä¸­ï¼Œå½“ä½¿ç”¨ <code>@Valid</code> æˆ– <code>@Validated</code> æ³¨è§£å¯¹æ§åˆ¶å™¨å±‚(Controller)æ–¹æ³•çš„å‚æ•°è¿›è¡Œæ ¡éªŒï¼Œå¹¶ä¸”æ ¡éªŒå¤±è´¥æ—¶ï¼ŒSpringä¼šè‡ªåŠ¨æŠ›å‡º <code>MethodArgumentNotValidException</code> å¼‚å¸¸ã€‚è¿™ä¸ªå¼‚å¸¸åŒ…å«äº†æ‰€æœ‰éªŒè¯å¤±è´¥çš„è¯¦ç»†ä¿¡æ¯ã€‚é€šè¿‡å…¨å±€å¼‚å¸¸å¤„ç†å™¨ï¼ˆä½¿ç”¨ <code>@ControllerAdvice</code> æˆ– <code>@RestControllerAdvice</code> æ³¨è§£æ ‡è®°çš„ç±»ï¼‰ä¸­å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œå¹¶ç”¨ <code>@ExceptionHandler(MethodArgumentNotValidException.class)</code> æ ‡è®°è¿™ä¸ªæ–¹æ³•ï¼Œå°±å¯ä»¥æ•è·åˆ°è¿™ä¸ªå¼‚å¸¸ï¼Œå¹¶è¿›è¡Œè‡ªå®šä¹‰çš„å¤„ç†ã€‚</p><p>è¿™é‡Œæ˜¯æ›´è¯¦ç»†çš„å®ç°ä»£ç ç¤ºä¾‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpStatus</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">ResponseEntity</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span></span><span class="token class-name">MethodArgumentNotValidException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">ExceptionHandler</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestControllerAdvice</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream<span class="token punctuation">.</span></span><span class="token class-name">Collectors</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestControllerAdvice</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GlobalExceptionHandler</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">MethodArgumentNotValidException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">handleValidationExceptions</span><span class="token punctuation">(</span><span class="token class-name">MethodArgumentNotValidException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ä»å¼‚å¸¸exä¸­æå–é”™è¯¯ä¿¡æ¯</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> errors <span class="token operator">=</span> ex<span class="token punctuation">.</span><span class="token function">getBindingResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFieldErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>fieldError <span class="token operator">-&gt;</span> fieldError<span class="token punctuation">.</span><span class="token function">getDefaultMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å°†é”™è¯¯ä¿¡æ¯ä»¥HTTPçŠ¶æ€ç 400ï¼ˆBAD REQUESTï¼‰è¿”å›</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>errors<span class="token punctuation">,</span> <span class="token class-name">HttpStatus</span><span class="token punctuation">.</span><span class="token constant">BAD_REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªæ–¹æ³•çš„å…³é”®æ˜¯ï¼Œå®ƒåˆ©ç”¨äº† <code>MethodArgumentNotValidException</code> å¼‚å¸¸ä¸­åŒ…å«çš„ <code>BindingResult</code> å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¿å­˜äº†æ‰€æœ‰çš„å­—æ®µé”™è¯¯(<code>FieldError</code>)ã€‚æ–¹æ³•é€šè¿‡æ˜ å°„(<code>map</code>)æ¯ä¸ª <code>FieldError</code> åˆ°å…¶é»˜è®¤æ¶ˆæ¯(<code>getDefaultMessage()</code>)æ¥è·å–æ‰€æœ‰éªŒè¯æ¶ˆæ¯ï¼Œå¹¶å°†å®ƒä»¬æ”¶é›†åˆ°ä¸€ä¸ªåˆ—è¡¨ä¸­ï¼Œæœ€ç»ˆè¿”å›è¿™ä¸ªåŒ…å«é”™è¯¯æ¶ˆæ¯çš„åˆ—è¡¨ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå‰ç«¯å¯ä»¥æ”¶åˆ°ä¸€ä¸ªåŒ…å«æ‰€æœ‰éªŒè¯é”™è¯¯ä¿¡æ¯çš„å“åº”ä½“ï¼Œä»è€Œèƒ½æä¾›æ›´å‡†ç¡®çš„ç”¨æˆ·åé¦ˆã€‚</p></div><h2 id="è¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨çš„åº”ç”¨" tabindex="-1"><a class="header-anchor" href="#è¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨çš„åº”ç”¨"><span>è¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨çš„åº”ç”¨</span></a></h2><p>åœ¨Spring MVCä¸­ï¼Œæ‹¦æˆªå™¨ï¼ˆInterceptorsï¼‰å’Œè¿‡æ»¤å™¨ï¼ˆFiltersï¼‰æ˜¯ä¸¤ç§åœ¨è¯·æ±‚å¤„ç†ç”Ÿå‘½å‘¨æœŸä¸­ä¸åŒé˜¶æ®µæ‹¦æˆªè¯·æ±‚è¿›è¡Œå¤„ç†çš„ç»„ä»¶ã€‚å®ƒä»¬éƒ½èƒ½å®ç°ç±»ä¼¼çš„åŠŸèƒ½ï¼Œä½†å®ƒä»¬çš„ä½¿ç”¨èŒƒå›´å’Œæ§åˆ¶ç²’åº¦ä¸åŒã€‚</p><h3 id="è¿‡æ»¤å™¨-filter" tabindex="-1"><a class="header-anchor" href="#è¿‡æ»¤å™¨-filter"><span>è¿‡æ»¤å™¨ï¼ˆFilterï¼‰</span></a></h3><p>è¿‡æ»¤å™¨æ˜¯åŸºäºJava Servlet APIçš„ä¸€éƒ¨åˆ†ã€‚è¿‡æ»¤å™¨ä¸»è¦ç”¨äºå¤„ç†ä¼ å…¥è¯·æ±‚å’Œä¼ å‡ºå“åº”çš„æ•°æ®æµï¼›å¤„ç†ç”¨æˆ·è®¤è¯ã€æ—¥å¿—è®°å½•ã€è¯·æ±‚æ•°æ®çš„é¢„å¤„ç†ç­‰ï¼›å¤šä¸ªè¿‡æ»¤å™¨å¯ä»¥æ„æˆä¸€ä¸ªè¿‡æ»¤é“¾ã€‚</p><h4 id="åº”ç”¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#åº”ç”¨ç¤ºä¾‹"><span>åº”ç”¨ç¤ºä¾‹</span></a></h4><p>åˆ›å»ºä¸€ä¸ªè¿‡æ»¤å™¨ç±»ï¼Œå®ç°<code>Filter</code>æ¥å£ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyFilter</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">FilterConfig</span> filterConfig<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{</span>
        <span class="token comment">// è¿‡æ»¤å™¨åˆå§‹åŒ–æ—¶è°ƒç”¨</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span><span class="token class-name">ServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">ServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">FilterChain</span> chain<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{</span>
        <span class="token comment">// åœ¨æ­¤å¤„ç¼–å†™è¿‡æ»¤é€»è¾‘ï¼Œä¾‹å¦‚æ—¥å¿—è®°å½•ã€å®‰å…¨æ£€æŸ¥ç­‰</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Filter is called before controller logic.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// ç»§ç»­è°ƒç”¨ä¸‹ä¸€ä¸ªè¿‡æ»¤å™¨æˆ–ç›®æ ‡èµ„æº</span>
        chain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// å“åº”è¿”å›ä¹‹åçš„å¤„ç†</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Filter is called after controller logic.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è¿‡æ»¤å™¨é”€æ¯æ—¶è°ƒç”¨</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨Springçš„é…ç½®æ–‡ä»¶æˆ–ç±»ä¸­æ³¨å†Œè¿‡æ»¤å™¨ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@WebFilter</span><span class="token punctuation">(</span>urlPatterns <span class="token operator">=</span> <span class="token string">&quot;/*&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyFilter</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ–è€…ï¼Œåœ¨Spring Booté¡¹ç›®ä¸­ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">FilterRegistrationBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MyFilter</span><span class="token punctuation">&gt;</span></span> <span class="token function">loggingFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">FilterRegistrationBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MyFilter</span><span class="token punctuation">&gt;</span></span> registrationBean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FilterRegistrationBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    registrationBean<span class="token punctuation">.</span><span class="token function">setFilter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    registrationBean<span class="token punctuation">.</span><span class="token function">addUrlPatterns</span><span class="token punctuation">(</span><span class="token string">&quot;/api/*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è®¾ç½®è¿‡æ»¤å™¨çš„URLæ¨¡å¼</span>
    <span class="token keyword">return</span> registrationBean<span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ‹¦æˆªå™¨-interceptor" tabindex="-1"><a class="header-anchor" href="#æ‹¦æˆªå™¨-interceptor"><span>æ‹¦æˆªå™¨ï¼ˆInterceptorï¼‰</span></a></h3><p>æ‹¦æˆªå™¨æ˜¯Spring MVCæä¾›çš„ä¸€ç§æ›´åŠ ç»†ç²’åº¦çš„è¯·æ±‚å¤„ç†æœºåˆ¶ï¼Œå®ƒæ›´åŠ ä¾èµ–äºSpringçš„ä¸Šä¸‹æ–‡ã€‚æ‹¦æˆªå™¨ä¸­å¯ä»¥æ³¨å…¥Springç®¡ç†çš„Beanï¼ŒåŒæ—¶å®ƒä»¬å¯ä»¥é’ˆå¯¹ç‰¹å®šçš„Controllerçš„æ–¹æ³•è¿›è¡Œæ‹¦æˆªæ“ä½œã€‚</p><h4 id="åº”ç”¨ç¤ºä¾‹-1" tabindex="-1"><a class="header-anchor" href="#åº”ç”¨ç¤ºä¾‹-1"><span>åº”ç”¨ç¤ºä¾‹</span></a></h4><p>åˆ›å»ºä¸€ä¸ªæ‹¦æˆªå™¨ç±»ï¼Œå®ç°<code>HandlerInterceptor</code>æ¥å£ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">HandlerInterceptor</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">preHandle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ§åˆ¶å™¨ï¼ˆControllerï¼‰æ–¹æ³•è°ƒç”¨ä¹‹å‰</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Interceptor preHandle method is called.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// å¿…é¡»è¿”å›trueï¼Œå¦åˆ™ä¼šé˜»æ­¢è¯·æ±‚ç»§ç»­è¿›è¡Œ</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">postHandle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">,</span> <span class="token class-name">ModelAndView</span> modelAndView<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ§åˆ¶å™¨ï¼ˆControllerï¼‰æ–¹æ³•è°ƒç”¨ä¹‹åï¼Œè§†å›¾æ¸²æŸ“ä¹‹å‰</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Interceptor postHandle method is called.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterCompletion</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">,</span> <span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ•´ä¸ªè¯·æ±‚ç»“æŸåï¼Œå³è§†å›¾æ¸²æŸ“ç»“æŸå</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Interceptor afterCompletion method is called.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨Springçš„é…ç½®ç±»ä¸­æ³¨å†Œæ‹¦æˆªå™¨ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebMvcConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addInterceptors</span><span class="token punctuation">(</span><span class="token class-name">InterceptorRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        registry<span class="token punctuation">.</span><span class="token function">addInterceptor</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addPathPatterns</span><span class="token punctuation">(</span><span class="token string">&quot;/api/**&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸‹è¡¨æ€»ç»“äº†è¿‡æ»¤å™¨ï¼ˆFilterï¼‰å’Œæ‹¦æˆªå™¨ï¼ˆInterceptorï¼‰åœ¨Java Webå¼€å‘ä¸­çš„ä¸åŒç‰¹ç‚¹ã€ä¼˜ç¼ºç‚¹ã€ä½¿ç”¨æ–¹å¼å’Œåº”ç”¨åœºæ™¯ï¼š</p><table><thead><tr><th>ç‰¹ç‚¹</th><th>è¿‡æ»¤å™¨ï¼ˆFilterï¼‰</th><th>æ‹¦æˆªå™¨ï¼ˆInterceptorï¼‰</th></tr></thead><tbody><tr><td>å®šä¹‰</td><td>åŸºäºServlet APIã€‚</td><td>åŸºäºSpringæ¡†æ¶ã€‚</td></tr><tr><td>é…ç½®æ–¹å¼</td><td>åœ¨web.xmlä¸­é…ç½®æˆ–é€šè¿‡@WebFilteræ³¨è§£ã€‚</td><td>åœ¨Springçš„é…ç½®ç±»ä¸­ç”¨WebMvcConfigurerçš„addInterceptorsæ–¹æ³•æ³¨å†Œã€‚</td></tr><tr><td>è°ƒç”¨æ—¶é—´</td><td>è¯·æ±‚è¿›å…¥Webå®¹å™¨åï¼Œè¿›å…¥Servletä¹‹å‰è°ƒç”¨ã€‚ å¤„ç†å®Œè¯·æ±‚åï¼Œè½¬å‘ç»™Servletæˆ–é™æ€èµ„æºä¹‹å‰ã€‚</td><td>è¯·æ±‚ç»è¿‡DispatcherServletåè°ƒç”¨ã€‚ åœ¨Controllerå¤„ç†ä¹‹å‰ã€ä¹‹åä»¥åŠè§†å›¾æ¸²æŸ“ä¹‹åè°ƒç”¨ã€‚</td></tr><tr><td>æ‹¦æˆªèŒƒå›´</td><td>å¯ä»¥å¯¹å‡ ä¹æ‰€æœ‰çš„è¯·æ±‚è¿›è¡Œæ“ä½œã€‚</td><td>åªèƒ½æ‹¦æˆªç»è¿‡DispatcherServletå¤„ç†çš„è¯·æ±‚ã€‚</td></tr><tr><td>å¯æ§åˆ¶ç²’åº¦</td><td>è¾ƒç²—ã€‚å› ä¸ºå®ƒä½äºWebå®¹å™¨çº§åˆ«ã€‚</td><td>è¾ƒç»†ã€‚å› ä¸ºå®ƒæ˜¯Springä¸Šä¸‹æ–‡ä¸­çš„ä¸€éƒ¨åˆ†ã€‚</td></tr><tr><td>èƒ½å¦æ³¨å…¥Spring Bean</td><td>ä¸å¯ä»¥ã€‚å› ä¸ºå®ƒä½äºå®¹å™¨çº§åˆ«ï¼Œä¸ç”±Springç®¡ç†ã€‚</td><td>å¯ä»¥ã€‚å› ä¸ºå®ƒè¢«Springç®¡ç†ã€‚</td></tr><tr><td>é€šå¸¸ä½¿ç”¨åœºæ™¯</td><td>- è¯·æ±‚æ—¥å¿—è®°å½•ã€‚<br>- è¯·æ±‚å’Œå“åº”çš„é€šç”¨å¤„ç†ï¼Œå¦‚è®¾ç½®å­—ç¬¦é›†ã€‚<br>- è®¿é—®æ§åˆ¶å’Œè®¤è¯ã€‚</td><td>- è®°å½•åº”ç”¨ç¨‹åºçš„è¡Œä¸ºã€‚<br>- å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œå¦‚æƒé™æ£€æŸ¥ã€‚<br>- æ›´ç»†ç²’åº¦çš„è¯·æ±‚å“åº”ä¿®æ”¹ã€‚</td></tr><tr><td>ä¼˜ç‚¹</td><td>- åº”ç”¨äºæ‰€æœ‰è¯·æ±‚ã€‚<br>- æ§åˆ¶è¯·æ±‚çš„æµå…¥æµå‡ºã€‚<br>- ä¸ä¾èµ–äºSpringã€‚<br>- å¯ä»¥å¯¹é™æ€èµ„æºè¯·æ±‚è¿›è¡Œæ‹¦æˆªã€‚</td><td>- å®Œå…¨é›†æˆäºSpringæ¡†æ¶ã€‚<br>- å¯ä»¥ä½¿ç”¨Springçš„åŠŸèƒ½ï¼Œå¦‚ä¾èµ–æ³¨å…¥ã€‚<br>- ä¸Controlleré›†æˆï¼Œå¯ä»¥å¯¹æ–¹æ³•è¿›è¡Œç²¾ç»†æ§åˆ¶ã€‚</td></tr><tr><td>ç¼ºç‚¹</td><td>- ä¸èƒ½å¾ˆå¥½åœ°ä¸Springé›†æˆã€‚<br>- ä¸èƒ½é€šè¿‡Springé…ç½®çµæ´»åœ°æ“ä½œè¯·æ±‚å’Œå“åº”ã€‚</td><td>- åªèƒ½ç”¨äºSpring or Spring Bootåº”ç”¨ã€‚<br>- ä¸ç›´æ¥ä½œç”¨äºä½çº§çš„è¯·æ±‚å’Œå“åº”å¯¹è±¡ã€‚</td></tr></tbody></table><p>è¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨éƒ½èƒ½å¤Ÿæä¾›ç±»ä¼¼çš„åŠŸèƒ½ï¼šå®ƒä»¬éƒ½å¯ä»¥åœ¨è¯·æ±‚çš„æŸä¸ªé˜¶æ®µè¿›è¡Œå¤„ç†ï¼Œå¦‚å®‰å…¨æ£€æŸ¥ã€æ—¥å¿—è®°å½•ç­‰ã€‚ç„¶è€Œï¼Œç”±äºSpringçš„æ‹¦æˆªå™¨æ›´å¥½åœ°ä¸Springç”Ÿæ€ç³»é›†æˆï¼Œé€šå¸¸å®ƒä»¬åœ¨ä½¿ç”¨Springè¿›è¡ŒWebå¼€å‘æ—¶æ›´åŠ æ–¹ä¾¿å’Œå¼ºå¤§ã€‚å¦ä¸€æ–¹é¢ï¼Œè¿‡æ»¤å™¨æä¾›äº†ä¸€ç§ä¸ä¾èµ–äºSpringçš„é€‰æ‹©ï¼Œå¯ä»¥åœ¨ä¸ä½¿ç”¨Springçš„åº”ç”¨ä¸­æˆ–è€…éœ€è¦åœ¨Servletä¹‹å‰è¿›è¡Œå¹²é¢„æ—¶ä½¿ç”¨ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œè¿‡æ»¤å™¨æ›´é€‚åˆäºè¯·æ±‚å…¥å£å’Œå‡ºå£å¤„çš„å…¬å…±å¤„ç†é€»è¾‘ï¼Œè€Œæ‹¦æˆªå™¨é€‚ç”¨äºä¸šåŠ¡å¤„ç†è¿‡ç¨‹ä¸­çš„ç»†èŠ‚æ§åˆ¶å’Œå¤„ç†ã€‚</p></div><!--[--><!----><!--]--><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/vuepress-theme-hope/vuepress-theme-hope/edit/main/src/java/spring/springmvc/core.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page on GitHub" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">Last update: </span><!----></div><div class="contributors"><span class="label">Contributors: </span><!--[--><!--[--><span class="contributor" title="email: msdrizzle@outlook.com">Neil</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link nav-link prev" href="/notebook/java/spring/springmvc/hello.html" aria-label="SpringMVCå¿«é€Ÿä¸Šæ‰‹"><div class="hint"><span class="arrow start"></span>Prev</div><div class="link"><!---->SpringMVCå¿«é€Ÿä¸Šæ‰‹</div></a><!----></nav><div id="vp-comment" class="giscus-wrapper input-top" style="display:block;"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" preserveAspectRatio="xMidYMid" viewBox="0 0 100 100"><circle cx="28" cy="75" r="11" fill="currentColor"><animate attributeName="fill-opacity" begin="0s" dur="1s" keyTimes="0;0.2;1" repeatCount="indefinite" values="0;1;1"></animate></circle><path fill="none" stroke="#88baf0" stroke-width="10" d="M28 47a28 28 0 0 1 28 28"><animate attributeName="stroke-opacity" begin="0.1s" dur="1s" keyTimes="0;0.2;1" repeatCount="indefinite" values="0;1;1"></animate></path><path fill="none" stroke="#88baf0" stroke-width="10" d="M28 25a50 50 0 0 1 50 50"><animate attributeName="stroke-opacity" begin="0.2s" dur="1s" keyTimes="0;0.2;1" repeatCount="indefinite" values="0;1;1"></animate></path></svg></div><!--[--><!----><!--]--><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">Default footer</div><div class="vp-copyright">Copyright Â© 2024 Mr.Topple </div></footer></div><!--]--><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/notebook/assets/app-CxJd8nF7.js" defer></script>
  </body>
</html>
